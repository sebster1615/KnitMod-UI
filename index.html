<?doctype html>
<html>
<head>
  <title>Procedural Knitting Editor</title>

  <!-- styles -->
  <link rel="shortcut icon" href="favicon.ico">
  <link rel="stylesheet" href="assets/style.css" />
  <link rel="stylesheet" href="libs/codemirror/lib/codemirror.css" />
  <!-- scripts -->
  <script type="text/javascript" src="js/skeleton.js"></script>
  <script type="text/javascript" src="libs/codemirror/lib/codemirror.js"></script>
  <script type="text/javascript" src="libs/codemirror/mode/javascript/javascript.js"></script>
<!--  <script src="bower_components/jquery/dist/jquery.js"></script>-->
<!--  <script src="bower_components/jquery-ui/ui/core.js"></script>-->
<!--  <script src="bower_components/jquery-ui/ui/widget.js"></script>-->
<!--  <script src="bower_components/jquery-ui/ui/accordion.js"></script>-->
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

  <style>
    .hidden {
      display: none;
    }
    body {
      /*text-align: center;*/
      font-family: Arial, sans-serif;
    }
    .controls {
      margin-bottom: 10px;
    }
    canvas {
      /*border: 1px solid black;*/
      /*cursor: pointer;*/
      position: absolute;
      top: 0;
      left: 0;
      cursor: grab;
    }
    #sweaterContainer {
      /*width: 420px;*/
      width: 40%;
      height: 800px;
      overflow: hidden;
      display: inline-block;
      border: 1px solid black;
      /*overflow: hidden;*/
      position: relative;
      /*display: inline-block;*/
      /*margin-top: 20px;*/
      left: 430px;
      top: -120px;
      /*position: absolute;*/
    }
    #sockContainer {
      /*width: 420px;*/
      width: 40%;
      height: 800px;
      overflow: hidden;
      display: inline-block;
      border: 1px solid black;
      /*overflow: hidden;*/
      position: relative;
      /*display: inline-block;*/
      /*margin-top: 20px;*/
      left: 430px;
      top: -100px;
      /*position: absolute;*/
    }
    #gloveContainer {
      width: 420px;
      height: 800px;
      overflow: hidden;
      display: inline-block;
      border: 1px solid black;
      /*overflow: hidden;*/
      position: relative;
      /*display: inline-block;*/
      /*margin-top: 20px;*/
      left: 430px;
      top: -330px;
      /*position: absolute;*/
    }
    #sweater-input-diagram {
      margin-top: 10px;
      width: 350px;
      height: 300px;
      position: absolute;
      background-color: #F2F2F2;
      mix-blend-mode: multiply;
      /*background: transparent;*/
      /*top: 100px;*/
      /*left: 0px;*/
    }
    #sock-input-diagram {
      margin-top: 10px;
      width: 250px;
      height: 300px;
      position: absolute;
      background-color: #F2F2F2;
      mix-blend-mode: multiply;
      /*background: transparent;*/
      /*top: 100px;*/
      /*left: 0px;*/
    }
    #glove-input-diagram {
      margin-top: 10px;
      width: 250px;
      height: 300px;
      position: absolute;
      background-color: #F2F2F2;
      mix-blend-mode: multiply;
      /*background: transparent;*/
      /*top: 100px;*/
      /*left: 0px;*/
    }
    #AF-Controls {
      position: absolute;
      top: 500px;
      left: 10px;
    }
    #output-container {
      position: absolute;
      top: 1000px;
      left: 10px;
    }
    #output-container-sock {
      position: absolute;
      top: 1000px;
      left: 10px;
    }
    #output-container-glove {
      position: absolute;
      top: 1000px;
      left: 10px;
    }
    #compile-buttons {
      position: absolute;
      top: 475px;
      left: 10px;
    }

    .hole-list-item {
      padding: 5px;
      margin: 5px 0;
      background: lightgray;
      cursor: pointer;
    }
    /*.garment-inputs {*/
    /*  width: 25%;*/
    /*  height: 20%;*/
    /*  position: absolute;*/
    /*  top: 80px;*/
    /*  left: 400px;*/
    /*}*/
    /*#sock-inputs {*/
    /*  width: 25%;*/
    /*  height: 20%;*/
    /*  position: absolute;*/
    /*  top: 80px;*/
    /*  left: 400px;*/
    /*}*/
    /*#glove-inputs {*/
    /*  width: 100%;*/
    /*  height: 20%;*/
    /*  position: absolute;*/
    /*  top: 80px;*/
    /*  left: 400px;*/
    /*}*/
    /*.text-box {*/
    /*  position: absolute;*/
    /*  background: rgba(255, 255, 255, 0.7);*/
    /*  border: 1px solid #000;*/
    /*  padding: 5px;*/
    /*}*/
  </style>
  <meta charset="utf-8" />
</head>

<body>
<div class="split left">
<!--  <label for="toggle-select">Select an option:</label>-->
<!--  <select id="toggle-select">-->
<!--    <option value="input">Number Input</option>-->
<!--    <option value="display">Display Value</option>-->
<!--  </select>-->
  <div class="KnitMod-UI">
    <label for="garment-select">Select a garment type:</label>
    <select name="garment-select" id="garment-select">
      <option value="Sweater" selected>Sweater</option>
      <option value="Sock">Sock</option>
      <option value="Glove">Glove</option>
    </select>
    <!--Base Input Measurements Used for Sweater Gen-->
    <div class="garment-inputs">
      <div id="torso-circumference-input-container">
        <label for="torso-circumference-input">(1) Upper torso circumference:</label>
        <input type="number" id="torso-circumference-input" />
      </div>
      <div id="right-arm-length-input-container">
        <label for="right-arm-length-input">(2) Right arm length:</label>
        <input type="number" id="right-arm-length-input" />
      </div>
      <div id="left-arm-length-input-container">
        <label for="left-arm-length-input">(3) Left arm length:</label>
        <input type="number" id="left-arm-length-input" />
      </div>
      <div id="torso-length-input-container">
        <label for="torso-length-input">(4) Torso length:</label>
        <input type="number" id="torso-length-input" />
      </div>
    </div>

    <div class="sock-inputs">
      <!--Base Input Measurements Used for Sock Gen-->
      <div id="foot-circumference-input-container">
        <label for="foot-circumference-input">Enter largest foot circumference:</label>
        <input type="number" id="foot-circumference-input" />
      </div>
      <div id="foot-length-input-container">
        <label for="foot-length-input">Enter foot length:</label>
        <input type="number" id="foot-length-input" />
      </div>
      <div id="sock-height-input-container">
        <label for="sock-height-input">Enter sock height:</label>
        <input type="number" id="sock-height-input" />
      </div>
    </div>

    <div id="glove-inputs">
      <!--Base Input Measurements Used for Sweater Gen-->
      <div id="palm-length-input-container">
        <label for="palm-length-input">Enter palm length:</label>
        <input type="number" id="palm-length-input" />
      </div>
      <div id="palm-circumference-input-container">
        <label for="palm-circumference-input">Enter palm circumference:</label>
        <input type="number" id="palm-circumference-input" />
      </div>
      <div id="wrist-length-input-container">
        <label for="wrist-length-input">Enter wrist length:</label>
        <input type="number" id="wrist-length-input" />
      </div>
      <div id="wrist-circumference-input-container">
        <label for="wrist-circumference-input">Enter wrist circumference:</label>
        <input type="number" id="wrist-circumference-input" />
      </div>
      <!--Finger Input Measurements for Glove-->
      <div id="index-finger-circumference-input-container">
        <label for="index-finger-circumference-input">Enter index finger circumference:</label>
        <input type="number" id="index-finger-circumference-input" />
      </div>
      <div id="index-finger-length-input-container">
        <label for="index-finger-length-input">Enter index finger length:</label>
        <input type="number" id="index-finger-length-input" />
      </div>
      <div id="middle-finger-circumference-input-container">
        <label for="middle-finger-circumference-input">Enter middle finger circumference:</label>
        <input type="number" id="middle-finger-circumference-input" />
      </div>
      <div id="middle-finger-length-input-container">
        <label for="middle-finger-length-input">Enter middle finger length:</label>
        <input type="number" id="middle-finger-length-input" />
      </div>
      <div id="ring-finger-circumference-input-container">
        <label for="ring-finger-circumference-input">Enter ring finger circumference:</label>
        <input type="number" id="ring-finger-circumference-input" />
      </div>
      <div id="ring-finger-length-input-container">
        <label for="ring-finger-length-input">Enter ring finger length:</label>
        <input type="number" id="ring-finger-length-input" />
      </div>
      <div id="pinky-finger-circumference-input-container">
        <label for="pinky-finger-circumference-input">Enter pinky finger circumference:</label>
        <input type="number" id="pinky-finger-circumference-input" />
      </div>
      <div id="pinky-finger-length-input-container">
        <label for="pinky-finger-length-input">Enter pinky finger length:</label>
        <input type="number" id="pinky-finger-length-input" />
      </div>
      <div id="thumb-circumference-input-container">
        <label for="thumb-circumference-input">Enter thumb circumference:</label>
        <input type="number" id="thumb-circumference-input" />
      </div>
      <div id="thumb-length-input-container">
        <label for="thumb-length-input">Enter thumb length:</label>
        <input type="number" id="thumb-length-input" />
      </div>
    </div>

    <div id="sweater-diagram">
      <img id="sweater-input-diagram" src="/knitskel/assets/icons/sweater_diagram.jpeg" alt="Background Image">
    </div>
    <div id="sock-diagram">
      <img id="sock-input-diagram" src="/knitskel/assets/icons/sock_diagram.jpeg" alt="Background Image">
    </div>
    <div id="glove-diagram">
      <img id="glove-input-diagram" src="/knitskel/assets/icons/glove_diagram.jpeg" alt="Background Image">
    </div>

  <!--Buttons Used for Sending Garment Measurements to Garment KnitScript/Python Program-->
    <div id="compile-buttons">
      <div id="compile-sweater-button-container">
        <button id="compile-sweater-button">Create Sweater</button>
        <button id="simulate-sweater-button">Simulate Sweater</button>
      </div>
      <div id="compile-sock-button-container">
        <button id="compile-sock-button">Create Sock</button>
        <button id="simulate-sock-button">Simulate Sock</button>
      </div>
      <div id="compile-glove-button-container">
        <button id="compile-glove-button">Create Glove</button>
        <button id="simulate-glove-button">Simulate Glove</button>
      </div>
    </div>

  <!--  <h2>Zoomable KnitGraph Sweater with Selectable Nodes</h2>-->
    <div id="AF-Controls">
      <label for="AF-select">Select an accessibility feature:</label>
      <select name="AF-select" id="AF-select">
        <option value="Hole" selected>Hole</option>
        <option value="Pocket">Pocket</option>
        <option value="Slit">Slit</option>
        <option value="Flap">Flap</option>
        <option value="Sleeve">Sleeve</option>
        <option value="Shape">Shape</option>
        <option value="Pattern">Pattern</option>
      </select>
      <div id = "hole-input-control">
        <div class="controls">
          <label>Hole Color: <input type="color" id="hole-nodeColor" value="#ff6a00"></label>
          <button id="applyHoleColor">Apply Feature</button>
        </div>
      </div>
      <div id = "pocket-input-control">
        <div class="controls">
          <label>Pocket Color: <input type="color" id="pocket-nodeColor" value="#08ff00"></label>
          <button id="applyPocketColor">Apply Feature</button>
        </div>
      </div>
      <div id = "slit-input-control">
        <div class="controls">
          <label>Slit Color: <input type="color" id="slit-nodeColor" value="#a600ff"></label>
          <button id="applySlitColors">Apply Feature</button>
        </div>
      </div>
      <div id = "flap-input-control">
        <div class="controls">
          <label for="Flap-orientation-select">Select Flap Orientation:</label>
          <select name="Flap-orientation-select" id="Flap-orientation-select">
            <option value="Side" selected>Side</option>
            <option value="Horizontal">Horizontal</option>
          </select>
          <div class="controls">
            <label for="Flap-side-select">Select Side to Attach Flap:</label>
            <select name="Flap-side-select" id="Flap-side-select">
              <option value="Right" selected>Right</option>
              <option value="Left">Left</option>
              <option value="Both">Both</option>
            </select>
          </div>
          <label for="Flap-bed-select">Select the Needle Bed for the Flap:</label>
          <select name="Flap-bed-select" id="Flap-bed-select">
            <option value="Front" selected>Front</option>
            <option value="Back">Back</option>
            <option value="Front-Back">Front & Back</option>
          </select>
          <div id="flap-length-container">
            <label for="flap-length-input">Enter the flap length:</label>
            <input type="number" id="flap-length-input" />
          </div>
          <label>Flap Color: <input type="color" id="flap-nodeColor" value="#FF000000"></label>
          <button id="applyFlapColors">Apply Feature</button>

        </div>
      </div>
    </div>
    <div id="sweaterContainer">
      <canvas id="sweaterCanvas"></canvas>
    </div>
    <div id="sockContainer">
      <canvas id="sockCanvas"></canvas>
    </div>
    <div id="gloveContainer">
      <canvas id="gloveCanvas"></canvas>
    </div>
<!-- output stitch locations of AFs for testing -->
    <div id="output-container">
      <button id="print-all-afs">Print Sweater AFs</button>
      <p id="output-afs-loc"></p>
      <button id="print-hole-value">Print Sweater Holes</button>
      <p id="output-hole-loc"></p>
      <button id="print-pocket-value">Print Sweater Pockets</button>
      <p id="output-pocket-loc"></p>
      <button id="print-slit-value">Print Sweater Slits</button>
      <p id="output-slit-loc"></p>
      <button id="print-flap-value">Print Sweater Flaps</button>
      <p id="output-flap-loc"></p>
    </div>

    <div id="output-container-sock">
      <button id="print-all-afs-sock">Print Sock AFs</button>
      <p id="output-afs-loc-sock"></p>
      <button id="print-hole-value-sock">Print Sock Holes</button>
      <p id="output-hole-loc-sock"></p>
      <button id="print-pocket-value-sock">Print Sock Pockets</button>
      <p id="output-pocket-loc-sock"></p>
      <button id="print-slit-value-sock">Print Sock Slits</button>
      <p id="output-slit-loc-sock"></p>
      <button id="print-flap-value-sock">Print Sock Flaps</button>
      <p id="output-flap-loc-sock"></p>
    </div>

    <div id="output-container-glove">
      <button id="print-all-afs-glove">Print Glove AFs</button>
      <p id="output-afs-loc-glove"></p>
      <button id="print-hole-value-glove">Print Glove Holes</button>
      <p id="output-hole-loc-glove"></p>
      <button id="print-pocket-value-glove">Print Glove Pockets</button>
      <p id="output-pocket-loc-glove"></p>
      <button id="print-slit-value-glove">Print Glove Slits</button>
      <p id="output-slit-loc-glove"></p>
      <button id="print-flap-value-glove">Print Glove Flaps</button>
      <p id="output-flap-loc-glove"></p>
    </div>

    <!--AF containers for sweater-->
    <div id="af-list-container">
      <!-- List items will appear here -->
    </div>
    <div id="hole-list-container">
      <!-- List items will appear here -->
    </div>
    <div id="pocket-list-container">
      <!-- List items will appear here -->
    </div>
    <div id="flap-list-container">
      <!-- List items will appear here -->
    </div>
    <div id="slit-list-container">
      <!-- List items will appear here -->
    </div>
    <div id="final-af-list-container">
      <!-- List items will appear here -->
    </div>

    <!--AF containers for sock-->
    <div id="af-list-container-sock">
      <!-- List items will appear here -->
    </div>
    <div id="hole-list-container-sock">
      <!-- List items will appear here -->
    </div>
    <div id="pocket-list-container-sock">
      <!-- List items will appear here -->
    </div>
    <div id="flap-list-container-sock">
      <!-- List items will appear here -->
    </div>
    <div id="slit-list-container-sock">
      <!-- List items will appear here -->
    </div>
    <div id="final-af-list-container-sock">
      <!-- List items will appear here -->
    </div>

    <!--AF containers for glove-->
    <div id="af-list-container-glove">
      <!-- List items will appear here -->
    </div>
    <div id="hole-list-container-glove">
      <!-- List items will appear here -->
    </div>
    <div id="pocket-list-container-glove">
      <!-- List items will appear here -->
    </div>
    <div id="flap-list-container-glove">
      <!-- List items will appear here -->
    </div>
    <div id="slit-list-container-glove">
      <!-- List items will appear here -->
    </div>
    <div id="final-af-list-container-glove">
      <!-- List items will appear here -->
    </div>
  </div>

<!--  <div id="number-display-container" class="hidden">-->
<!--    <span id="number-display">No number selected</span>-->
<!--  </div>-->

  <script>
    $(document).ready(function () {
      let full_af_list = []; //for sweater
      let full_af_list_sock = []; //for sock
      let full_af_list_glove = [];
      // Initialize the selectmenu widget
      $("#garment-select").selectmenu();

      // Change behavior based on the selected option
      $("#garment-select").on("selectmenuchange", function () {
        var selectedOption = $(this).val();

        // Show or hide elements based on the selected option
        if (selectedOption === "Sweater") {
          //show sweater canvas and hide others
          $("#sweaterContainer").show();
          $("#sockContainer").hide();
          $("#gloveContainer").hide();

          $("#compile-sweater-button-container").show();
          $("#compile-glove-button-container").hide();
          $("#compile-sock-button-container").hide();
          // Show Sweater Input Fields
          $("#torso-circumference-input-container").show();
          $("#torso-length-input-container").show();
          $("#left-arm-length-input-container").show();
          $("#right-arm-length-input-container").show();
          $("#sweater-input-diagram").show();
          // Hide Other Garment Input Fields
          $("#sock-input-diagram").hide();
          $("#glove-input-diagram").hide();
          $("#foot-circumference-input-container").hide();
          $("#foot-length-input-container").hide();
          $("#sock-height-input-container").hide();
          $("#palm-circumference-input-container").hide();
          $("#palm-length-input-container").hide();
          $("#wrist-circumference-input-container").hide();
          $("#wrist-length-input-container").hide();
          $("#index-finger-circumference-input-container").hide();
          $("#index-finger-length-input-container").hide();
          $("#middle-finger-circumference-input-container").hide();
          $("#middle-finger-length-input-container").hide();
          $("#ring-finger-circumference-input-container").hide();
          $("#ring-finger-length-input-container").hide();
          $("#pinky-finger-circumference-input-container").hide();
          $("#pinky-finger-length-input-container").hide();
          $("#thumb-circumference-input-container").hide();
          $("#thumb-length-input-container").hide();

          //show hole input as this is initialized one, hide rest

          $("#hole-input-control").show();
          //for sweater
          $("#pocket-input-control").hide();
          $("#slit-input-control").hide();
          $("#flap-input-control").hide();

          $("#output-container").show();

          //for sock
          $("#output-container-sock").hide();
          // $("#hole-input-control-sock").hide();
          // $("#pocket-input-control-sock").hide();
          // $("#slit-input-control-sock").hide();
          // $("#flap-input-control-sock").hide();
          //for glove
          $("#output-container-glove").hide();
          // $("#hole-input-control-glove").hide();
          // $("#pocket-input-control-glove").hide();
          // $("#slit-input-control-glove").hide();
          // $("#flap-input-control-glove").hide();


        } else if (selectedOption === "Sock") {
          //show sock canvas and hide others
          $("#sweaterContainer").hide();
          $("#sockContainer").show();
          $("#gloveContainer").hide();

          $("#compile-sweater-button-container").hide();
          $("#compile-glove-button-container").hide();
          $("#compile-sock-button-container").show();
          // Show Sweater Input Fields
          $("#foot-circumference-input-container").show();
          $("#foot-length-input-container").show();
          $("#sock-height-input-container").show();
          $("#sock-input-diagram").show();

          // Hide Other Garment Input Fields
          $("#sweater-input-diagram").hide();
          $("#glove-input-diagram").hide();
          $("#torso-circumference-input-container").hide();
          $("#torso-length-input-container").hide();
          $("#palm-circumference-input-container").hide();
          $("#palm-length-input-container").hide();
          $("#wrist-circumference-input-container").hide();
          $("#wrist-length-input-container").hide();
          $("#index-finger-circumference-input-container").hide();
          $("#index-finger-length-input-container").hide();
          $("#middle-finger-circumference-input-container").hide();
          $("#middle-finger-length-input-container").hide();
          $("#ring-finger-circumference-input-container").hide();
          $("#ring-finger-length-input-container").hide();
          $("#pinky-finger-circumference-input-container").hide();
          $("#pinky-finger-length-input-container").hide();
          $("#thumb-circumference-input-container").hide();
          $("#thumb-length-input-container").hide();
          $("#left-arm-length-input-container").hide();
          $("#right-arm-length-input-container").hide();

          //show hole input as this is initialized one, hide rest
          $("#hole-input-control").show();
          $("#pocket-input-control").hide();
          $("#slit-input-control").hide();
          $("#flap-input-control").hide();
          //for sock
          $("#output-container-sock").show();
          // $("#pocket-input-control-sock").hide();
          // $("#slit-input-control-sock").hide();
          // $("#flap-input-control-sock").hide();
          //for sweater
          $("#output-container").hide();
          // $("#hole-input-control").hide();
          // $("#pocket-input-control").hide();
          // $("#slit-input-control").hide();
          // $("#flap-input-control").hide();
          //for glove
          $("#output-container-glove").hide();
          // $("#hole-input-control-glove").hide();
          // $("#pocket-input-control-glove").hide();
          // $("#slit-input-control-glove").hide();
          // $("#flap-input-control-glove").hide();
          //var number = $("#number-input").val();
          //$("#number-display").text(number ? number : "No number selected");
          // $("#number-input-container").hide();
          // $("#number-display-container").show();
        } else if (selectedOption === "Glove") {
          //show glove canvas and hide others
          $("#sweaterContainer").hide();
          $("#sockContainer").hide();
          $("#gloveContainer").show();

          $("#compile-sweater-button-container").hide();
          $("#compile-glove-button-container").show();
          $("#compile-sock-button-container").hide();



          $("#palm-circumference-input-container").show();
          $("#palm-length-input-container").show();
          $("#wrist-circumference-input-container").show();
          $("#wrist-length-input-container").show();
          $("#index-finger-circumference-input-container").show();
          $("#index-finger-length-input-container").show();
          $("#middle-finger-circumference-input-container").show();
          $("#middle-finger-length-input-container").show();
          $("#ring-finger-circumference-input-container").show();
          $("#ring-finger-length-input-container").show();
          $("#thumb-circumference-input-container").show();
          $("#thumb-length-input-container").show();
          $("#pinky-finger-circumference-input-container").show();
          $("#pinky-finger-length-input-container").show();
          $("#glove-input-diagram").show();

          // Hide Other Garment Input Fields
          $("#sock-input-diagram").hide();
          $("#sweater-input-diagram").hide();
          $("#foot-circumference-input-container").hide();
          $("#foot-length-input-container").hide();
          $("#sock-height-input-container").hide();
          $("#torso-circumference-input-container").hide();
          $("#torso-length-input-container").hide();
          $("#left-arm-length-input-container").hide();
          $("#right-arm-length-input-container").hide();

          //show hole input as this is initialized one, hide rest
          // $("#hole-input-control-glove").show();

          $("#hole-input-control").show();
          $("#pocket-input-control").hide();
          $("#slit-input-control").hide();
          $("#flap-input-control").hide();
          //for glove
          $("#output-container-glove").show();
          // $("#pocket-input-control-glove").hide();
          // $("#slit-input-control-glove").hide();
          // $("#flap-input-control-glove").hide();
          //for sweater
          $("#output-container").hide();
          // $("#hole-input-control").hide();
          // $("#pocket-input-control").hide();
          // $("#slit-input-control").hide();
          // $("#flap-input-control").hide();
          //for sock
          $("#output-container-sock").hide();
          // $("#hole-input-control-sock").hide();
          // $("#pocket-input-control-sock").hide();
          // $("#slit-input-control-sock").hide();
          // $("#flap-input-control-sock").hide();
          //var number = $("#number-input").val();
          // $("#number-display").text(number ? number : "No number selected");
          // $("#number-input-container").hide();
          // $("#number-display-container").show();
        }
      });

      // Initial state, show the number input by default
      //show glove canvas and hide others
      $("#sweaterContainer").show();
      $("#sockContainer").hide();
      $("#gloveContainer").hide()

      $("#sweater-input-diagram").show();
      $("#sock-input-diagram").hide();
      $("#glove-input-diagram").hide();

      $("#torso-circumference-input-container").show();
      $("#torso-length-input-container").show();
      $("#left-arm-length-input-container").show();
      $("#right-arm-length-input-container").show();
      $("#compile-sweater-button-container").show();
      $("#compile-glove-button-container").hide();
      $("#compile-sock-button-container").hide();
      $("#palm-circumference-input-container").hide();
      $("#palm-length-input-container").hide();
      $("#wrist-circumference-input-container").hide();
      $("#wrist-length-input-container").hide();
      $("#index-finger-circumference-input-container").hide();
      $("#index-finger-length-input-container").hide();
      $("#middle-finger-circumference-input-container").hide();
      $("#middle-finger-length-input-container").hide();
      $("#ring-finger-circumference-input-container").hide();
      $("#ring-finger-length-input-container").hide();
      $("#pinky-finger-circumference-input-container").hide();
      $("#pinky-finger-length-input-container").hide();
      $("#thumb-circumference-input-container").hide();
      $("#thumb-length-input-container").hide();
      $("#foot-circumference-input-container").hide();
      $("#foot-length-input-container").hide();
      $("#sock-height-input-container").hide();
      // $("#number-input-container").show();
      // $("#number-display-container").hide();
      //initial values
      $("#hole-input-control").show();

      $("#pocket-input-control").hide();
      $("#slit-input-control").hide();
      $("#flap-input-control").hide();
      $("#output-container").show();
      $("#output-container-glove").hide();
      $("#output-container-sock").hide();
      // $("#hole-input-control-sock").hide();
      // $("#pocket-input-control-sock").hide();
      // $("#slit-input-control-sock").hide();
      // $("#flap-input-control-sock").hide();
      // $("#hole-input-control-glove").hide();
      // $("#pocket-input-control-glove").hide();
      // $("#slit-input-control-glove").hide();
      // $("#flap-input-control-glove").hide();
      var relativeHeight = 0; //used to calculate needle height relative to the section it is located


      $("#compile-sweater-button").click(function () {
        // Collect measurements for sweater garment
        var torso_circum = $("#torso-circumference-input").val();
        var torso_len = $("#torso-length-input").val();
        var left_arm_len = $("#left-arm-length-input").val();
        var right_arm_len = $("#right-arm-length-input").val();

        // Compact Measurements
        var sweater_measurements = {
          torso_circum: torso_circum,
          torso_len: torso_len,
          left_arm_len: left_arm_len,
          right_arm_len: right_arm_len
        };

        // Send data to Python server using AJAX
        $.ajax({
          url: "http://127.0.0.1:5000/sweater_inputs",  // Flask endpoint
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify(sweater_measurements),
          success: function (response) {
            console.log("Response from Python:", response);
          },
          error: function (error) {
            console.error("Error:", error);
          }
        });
        // *****START OF KnitMod UI

        //*** SWEATER DIMS ***
        //add in input box on UI for gauge and vert_gauge
        let gauge = 12;
        let vert_gauge = gauge * 1.8; //18?
        let torsoWidth = Math.floor((gauge * torso_circum));//160;
        let torsoHeight = Math.floor(vert_gauge * torso_len);
        let leftSleeveHeight = Math.floor(vert_gauge * left_arm_len);
        let rightSleeveHeight = Math.floor(vert_gauge * right_arm_len);
        if (torsoWidth % 2 !== 0){
          torsoWidth += 1;
        }

        let neckWidth = Math.floor((torsoWidth * 0.4));
        let leftSleeveUpperWidth = Math.floor((torsoWidth * 0.45));
        let leftSleeveLowerWidth = Math.floor((torsoWidth * 0.25));
        if (neckWidth % 2 !== 0){
          neckWidth += 1;
        }
        if (leftSleeveUpperWidth % 2 !== 0){
          leftSleeveUpperWidth += 1;
        }
        if (leftSleeveLowerWidth % 2 !== 0){
          leftSleeveLowerWidth += 1;
        }
        neckWidth = Math.floor(neckWidth/2);
        leftSleeveUpperWidth = Math.floor(leftSleeveUpperWidth/2);
        leftSleeveLowerWidth = Math.floor(leftSleeveLowerWidth/2);
        let leftDenom = Math.floor((leftSleeveUpperWidth - leftSleeveLowerWidth)/2);
        let leftSleeveSlopeInc = Math.floor(leftSleeveHeight/leftDenom);

        let rightSleeveUpperWidth= Math.floor((torsoWidth * 0.45));
        let rightSleeveLowerWidth = Math.floor((torsoWidth * 0.25));
        if (rightSleeveUpperWidth % 2 !== 0){
          rightSleeveUpperWidth += 1;
        }
        if (rightSleeveLowerWidth % 2 !== 0){
          rightSleeveLowerWidth += 1;
        }
        rightSleeveUpperWidth = Math.floor(rightSleeveUpperWidth/2);
        rightSleeveLowerWidth = Math.floor(rightSleeveLowerWidth/2);
        let rightDenom = Math.floor((rightSleeveUpperWidth - rightSleeveLowerWidth)/2);
        let rightSleeveSlopeInc = Math.floor(rightSleeveHeight/rightDenom);

        torsoWidth = Math.floor(torsoWidth/2);

        let neckHeight = Math.floor((torsoWidth-neckWidth)/4);
        let upperShoulderWidth = torsoWidth;
        let lowerShoulderWidth = torsoWidth + leftSleeveUpperWidth + rightSleeveUpperWidth;
        let upperShoulderHeight = Math.floor(((torsoWidth + leftSleeveUpperWidth + rightSleeveUpperWidth) - upperShoulderWidth)/2);
        let lowerShoulderHeight = Math.floor(upperShoulderHeight/2);


        if ((upperShoulderWidth-neckWidth) % 2 !== 0){
          neckWidth += 1;
          //neckHeight += 1;
          //upperShoulderHeight -= 1;
        }
        //let sleeveTaper = 20;      // Controls how much sleeves narrow
        //let collarWidth = 40;      // Width of collar
        //let collarHeight = 10;     // Height of collar

        let totalWidth = torsoWidth + leftSleeveUpperWidth + rightSleeveUpperWidth;
        let totalHeight = torsoHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight + 2;
        if ((leftSleeveHeight > torsoHeight) && (leftSleeveHeight > rightSleeveHeight)) {
          totalHeight -= torsoHeight;
          totalHeight += leftSleeveHeight;
        }else if ((rightSleeveHeight > torsoHeight) && (rightSleeveHeight > leftSleeveHeight)) {
          totalHeight -= torsoHeight;
          totalHeight += rightSleeveHeight;
        }else if ((rightSleeveHeight > torsoHeight || leftSleeveHeight > torsoHeight) && (rightSleeveHeight === leftSleeveHeight)){
          totalHeight -= torsoHeight;
          totalHeight += rightSleeveHeight;
        }
        let neck_start_needle = Math.floor((totalWidth - neckWidth) / 2);

        if ((upperShoulderWidth-(neckWidth+((neckHeight-1)*4))) % 6 === 0){
          neckWidth += 2;
          neck_start_needle -= 1;
        }
        let nodeSize = 5;  // Each stitch (smaller for large grids)
        let gap = 1;       // Space between nodes

        let canvas = document.getElementById("sweaterCanvas");
        let ctx = canvas.getContext("2d");

        // Canvas scale factor (used for zooming)
        let scaleFactor = 1;

        // Initial Colors for the sweater
        let colors = {
          neck: "#0022ff",
          upperShoulder: "#2d4efa",
          lowerShoulder: "#637df8",
          leftSleeve: "#93a9f6",
          rightSleeve: "#93a9f6",
          torso: "#c3d7ff",
          afNodes: "#FF0000",
          holeNodes: "#ff6a00",
          pocketNodes: "#08ff00",
          flapNodes: "#000000",
          slitNodes: "#a600ff",
        };

        let afNodes = {}; // To store selected nodes
        let holeNodes = {};
        let pocketNodes = {};
        let flapNodes = {};
        let slitNodes = {};
        let currentGroupColor = "#FF0000";

        var duplicateSectionName = false;

        // Adjust canvas size dynamically
        function adjustCanvasSize() {
          canvas.width = (totalWidth * (nodeSize + gap)) * scaleFactor + 20;
          canvas.height = (totalHeight * (nodeSize + gap)) * scaleFactor + 20;
        }

        // Draw the sweater graph with the current scale
        function drawSweater() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          let neckInc = 0;
          let upperSoulderInc = 0;
          let inc1 = 0;
          let inc2 = 0;
          let left_sleeve_count = 0;
          let right_sleeve_count = 0;

          currentGroupColor = "#FF0000";
          // Adjust for zooming (scaleFactor is applied here)

          for (let row = 0; row < totalHeight; row++) {

            for (let col = 0; col < totalWidth; col++) {
              let x = (col * (nodeSize + gap) + 10) * scaleFactor;
              let y = (row * (nodeSize + gap) + 10) * scaleFactor;
              let nodeColor = "white"; // Default -> empty node

              // Neck to shoulders (width increase of two nodes per row)
              if ((row < neckHeight) && (col >= (neck_start_needle - neckInc)) && (col < (neck_start_needle+neckWidth + neckInc))){
                //print(neckInc);
                nodeColor = colors.neck;
              }
              //upper shoulders (width increase of one node per row)
              else if ((neckHeight <= row) && (row < (neckHeight + upperShoulderHeight)) && (col >= (leftSleeveUpperWidth - (upperSoulderInc))) && (col < (leftSleeveUpperWidth + torsoWidth + upperSoulderInc))){
                nodeColor = colors.upperShoulder;
              }
              //lower shoulders (constant width)
              else if (((neckHeight + upperShoulderHeight) <= row) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (col >= 0) && (col < lowerShoulderWidth)){
                nodeColor = colors.lowerShoulder;
              }
              // Left Sleeve (Tapered both sides by calculated slope)
              if ((row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + leftSleeveHeight))) {
                if ((col < (leftSleeveUpperWidth - (inc1))) && (col >= (inc1))) {
                  nodeColor = colors.leftSleeve;
                  //left_sleeve_count = left_sleeve_count + 1;
                }
              }
              // Right Sleeve (Tapered both sides by calculated slope)
              if ((row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + rightSleeveHeight))) {
                if ((col < (totalWidth - (inc2))) && (col >= (leftSleeveUpperWidth+torsoWidth + (inc2)))) {
                  nodeColor = colors.rightSleeve;
                  // right_sleeve_count = right_sleeve_count + 1;
                }
              }
              // Body (constant width)
              if ((row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + torsoHeight))){
                if ((col >= (leftSleeveUpperWidth)) && (col < (totalWidth - rightSleeveUpperWidth))) {
                  nodeColor = colors.torso;
                }
              }
              // if(col === 0){
              //     nodeColor = colors.testColor;
              // }

              // If the node is selected, update the color for selected AF

              if (afNodes[`${row}-${col}`]) {
                nodeColor = afNodes[`${row}-${col}`];
                var afNodeLoc = `[${row},${col}]`;
                var duplicate = false;

                $(".af-list-item").each(function () {
                  if ($(this).text() === afNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                });
                if (!duplicate) {
                  $("#af-list-container").append('<div class="af-list-item">' + `[${row},${col}]` + '</div>')
                }
              }

              var neck = '"Neck"';
              var upperShoulders = '"Upper_Shoulders"';
              var lowerShoulders = '"Lower_Shoulders"';
              var leftSleeve = '"Arm2"'; //left sleeve
              var rightSleeve = '"Arm1"'; //right sleeve
              var torso = '"Torso"';

              var torsoDuplicate = false;
              var leftSleeveDuplicate = false;
              var rightSleeveDuplicate = false;
              var lowerShoulderDuplicate = false;
              var upperShoulderDuplicate = false;
              var neckDuplicate = false;


                // ctx.fillStyle = nodeColor;
              if (holeNodes[`${row}-${col}`]) {
                // nodeColor = holeNodes[`${row}-${col}`];
                // ctx.fillStyle = nodeColor;
                ctx.fillStyle = holeNodes[`${row}-${col}`];
                var holeNodeLoc = `[${row},${col}]`;
                //var duplicate = false;

                $(".hole-list-item").each(function () {
                  if (($(this).text() === holeNodeLoc) ){
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === neck)) {
                    neckDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === upperShoulders)) {
                    upperShoulderDuplicate = true;
                  }
                  if (($(this).text() === lowerShoulders)) {
                    lowerShoulderDuplicate = true;
                  }
                  if (($(this).text() === rightSleeve)) {
                    rightSleeveDuplicate = true;
                  }
                  if (($(this).text() === torso)) {
                    torsoDuplicate = true;
                  }
                  if (($(this).text() === leftSleeve)) {
                    leftSleeveDuplicate = true;
                  }
                });

                //add section tag to hole container

                // Body (constant width)
                if ((row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + leftSleeveHeight))) {
                  if ((col < (leftSleeveUpperWidth - (inc1 + 1))) && (col >= (inc1 + 1))) {
                    if (!leftSleeveDuplicate) {
                      if ($("#hole-list-container div:first").text() === lowerShoulders) {
                        $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Arm2"' + '</div>');
                      }else{
                        $("#hole-list-container").append('<div class="hole-list-item">' + '"Arm2"' + '</div>');
                      }
                      relativeHeight = (leftSleeveHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                    }
                  }
                }
                if ( (row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + torsoHeight))) {
                  if ((col >= (leftSleeveUpperWidth)) && (col < (totalWidth - rightSleeveUpperWidth))) {
                    if (!torsoDuplicate) {
                      //$("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Torso"' + '</div>');
                      if ($("#hole-list-container div:first").text() === lowerShoulders) {
                        $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Torso"' + '</div>');
                      }else{
                        $("#hole-list-container").append('<div class="hole-list-item">' + '"Torso"' + '</div>');
                      }
                      relativeHeight = (torsoHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                      //torsoDuplicate = true;
                    }
                  }
                }
                if ( (row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + rightSleeveHeight))) {
                  if ((col < (totalWidth - (inc2 + 1))) && (col >= (leftSleeveUpperWidth + torsoWidth + (inc2 + 1)))) {
                    if (!rightSleeveDuplicate) {
                      if ($("#hole-list-container div:first").text() === lowerShoulders) {
                        $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Arm1"' + '</div>');
                      }else{
                        $("#hole-list-container").append('<div class="hole-list-item">' + '"Arm1"' + '</div>');
                      }
                      relativeHeight = (rightSleeveHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                    }
                  }
                }
                if (((neckHeight + upperShoulderHeight) <= row) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (col >= 0) && (col < lowerShoulderWidth)) {
                  if (!lowerShoulderDuplicate) {
                    if ($("#hole-list-container div:first").text() === upperShoulders) {
                      // Replace the first div with the new content
                      $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Lower_Shoulders"' + '</div>');
                    }else{
                      $("#hole-list-container").append('<div class="hole-list-item">' + '"Lower_Shoulders"' + '</div>');
                    }
                    relativeHeight = (lowerShoulderHeight + upperShoulderHeight + neckHeight);
                  }
                }
                if ((neckHeight <= row) && (row < (neckHeight + upperShoulderHeight)) && (col >= (leftSleeveUpperWidth - (upperSoulderInc))) && (col < (leftSleeveUpperWidth + torsoWidth + upperSoulderInc))) {
                  if (!upperShoulderDuplicate) {
                    if ($("#hole-list-container div:first").text() === neck) {
                      $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Upper_Shoulders"' + '</div>');
                    }else {
                      $("#hole-list-container").append('<div class="hole-list-item">' + '"Upper_Shoulders"' + '</div>');
                    }
                    relativeHeight = (upperShoulderHeight + neckHeight);
                  }
                }
                if (((row < neckHeight) && (col >= (Math.round((totalWidth - neckWidth) / 2) - neckInc)) && (col < (Math.round((totalWidth + neckWidth) / 2) + neckInc)))) {
                  if(!neckDuplicate) {
                    $("#hole-list-container").append('<div class="hole-list-item">' + '"Neck"' + '</div>');
                    relativeHeight = (neckHeight);
                  }
                }


                //add needle locations
                if (!duplicate && (afNodes[`${row}-${col}`] === colors.holeNodes)) {
                  $("#hole-list-container").append('<div class="hole-list-item">' + `[${row},${col}]` + '</div>');
                }

                // //sort by row position
                // var hole_items = $(".hole-list-item").get();
                // hole_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                // $("#hole-list-container").empty().append(hole_items);
                //let holes = $("#hole-list-container").clone();
              }else if (pocketNodes[`${row}-${col}`]) {
                ctx.fillStyle = pocketNodes[`${row}-${col}`];
                var pocketNodeLoc = `[${row},${col}]`;
                var duplicateSectionNamePocket = false;
                //var duplicate = false;

                $(".pocket-list-item").each(function () {
                  if ($(this).text() === pocketNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === neck)) {
                    neckDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === upperShoulders)) {
                    upperShoulderDuplicate = true;
                  }
                  if (($(this).text() === lowerShoulders)) {
                    lowerShoulderDuplicate = true;
                  }
                  if (($(this).text() === rightSleeve)) {
                    rightSleeveDuplicate = true;
                  }
                  if (($(this).text() === torso)) {
                    torsoDuplicate = true;
                  }
                  if (($(this).text() === leftSleeve)) {
                    leftSleeveDuplicate = true;
                  }
                });

                //add section tag to pocket container
                if ((row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + leftSleeveHeight))) {
                  if ((col < (leftSleeveUpperWidth - (inc1 + 1))) && (col >= (inc1 + 1))) {
                    if (!leftSleeveDuplicate) {
                      if ($("#pocket-list-container div:first").text() === lowerShoulders) {
                        $("#pocket-list-container div:first").replaceWith('<div class="pocket-list-item">' + '"Arm2"' + '</div>');
                      }else{
                        $("#pocket-list-container").append('<div class="pocket-list-item">' + '"Arm2"' + '</div>');
                      }
                      relativeHeight = (leftSleeveHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                    }
                  }
                }
                if ( (row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + torsoHeight))) {
                  if ((col >= (leftSleeveUpperWidth)) && (col < (totalWidth - rightSleeveUpperWidth))) {
                    if (!torsoDuplicate) {
                      //$("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Torso"' + '</div>');
                      if ($("#pocket-list-container div:first").text() === lowerShoulders) {
                        $("#pocket-list-container div:first").replaceWith('<div class="pocket-list-item">' + '"Torso"' + '</div>');
                      }else{
                        $("#pocket-list-container").append('<div class="pocket-list-item">' + '"Torso"' + '</div>');
                      }
                      relativeHeight = (torsoHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                      //torsoDuplicate = true;
                    }
                  }
                }
                if ( (row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + rightSleeveHeight))) {
                  if ((col < (totalWidth - (inc2 + 1))) && (col >= (leftSleeveUpperWidth + torsoWidth + (inc2 + 1)))) {
                    if (!rightSleeveDuplicate) {
                      if ($("#pocket-list-container div:first").text() === lowerShoulders) {
                        $("#pocket-list-container div:first").replaceWith('<div class="pocket-list-item">' + '"Arm1"' + '</div>');
                      }else{
                        $("#pocket-list-container").append('<div class="pocket-list-item">' + '"Arm1"' + '</div>');
                      }
                      relativeHeight = (rightSleeveHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                    }
                  }
                }
                if (((neckHeight + upperShoulderHeight) <= row) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (col >= 0) && (col < lowerShoulderWidth)) {
                  if (!lowerShoulderDuplicate) {
                    if ($("#pocket-list-container div:first").text() === upperShoulders) {
                      // Replace the first div with the new content
                      $("#pocket-list-container div:first").replaceWith('<div class="pocket-list-item">' + '"Lower_Shoulders"' + '</div>');
                    }else{
                      $("#pocket-list-container").append('<div class="pocket-list-item">' + '"Lower_Shoulders"' + '</div>');
                    }
                    relativeHeight = (lowerShoulderHeight + upperShoulderHeight + neckHeight);
                  }
                }
                if ((neckHeight <= row) && (row < (neckHeight + upperShoulderHeight)) && (col >= (leftSleeveUpperWidth - (upperSoulderInc))) && (col < (leftSleeveUpperWidth + torsoWidth + upperSoulderInc))) {
                  if (!upperShoulderDuplicate) {
                    if ($("#pocket-list-container div:first").text() === neck) {
                      $("#pocket-list-container div:first").replaceWith('<div class="pocket-list-item">' + '"Upper_Shoulders"' + '</div>');
                    }else {
                      $("#pocket-list-container").append('<div class="pocket-list-item">' + '"Upper_Shoulders"' + '</div>');
                    }
                    relativeHeight = (upperShoulderHeight + neckHeight);
                  }
                }
                if (((row < neckHeight) && (col >= (Math.round((totalWidth - neckWidth) / 2) - neckInc)) && (col < (Math.round((totalWidth + neckWidth) / 2) + neckInc)))) {
                  if (!neckDuplicate) {
                    $("#pocket-list-container").append('<div class="pocket-list-item">' + '"Neck"' + '</div>');
                    relativeHeight = (neckHeight);
                  }
                }

                if (!duplicate) {
                  $("#pocket-list-container").append('<div class="pocket-list-item">' + `[${row},${col}]` + '</div>')
                }
                //sort by row position
                // var pocket_items = $(".pocket-list-item").get();
                // pocket_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                //$("#pocket-list-container").empty().append(pocket_items);
              }else if (slitNodes[`${row}-${col}`]) {
                nodeColor = slitNodes[`${row}-${col}`];
                ctx.fillStyle = nodeColor;
                var slitNodeLoc = `[${row},${col}]`;
                var duplicateSectionNameSlit = false;
                //var duplicate = false;

                $(".slit-list-item").each(function () {
                  if ($(this).text() === slitNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === neck)) {
                    neckDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === upperShoulders)) {
                    upperShoulderDuplicate = true;
                  }
                  if (($(this).text() === lowerShoulders)) {
                    lowerShoulderDuplicate = true;
                  }
                  if (($(this).text() === rightSleeve)) {
                    rightSleeveDuplicate = true;
                  }
                  if (($(this).text() === torso)) {
                    torsoDuplicate = true;
                  }
                  if (($(this).text() === leftSleeve)) {
                    leftSleeveDuplicate = true;
                  }
                });

                //add section tag to slit container
                //add section tag to pocket container
                if ((row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + leftSleeveHeight))) {
                  if ((col < (leftSleeveUpperWidth - (inc1 + 1))) && (col >= (inc1 + 1))) {
                    if (!leftSleeveDuplicate) {
                      if ($("#slit-list-container div:first").text() === lowerShoulders) {
                        $("#slit-list-container div:first").replaceWith('<div class="slit-list-item">' + '"Arm2"' + '</div>');
                      }else{
                        $("#slit-list-container").append('<div class="slit-list-item">' + '"Arm2"' + '</div>');
                      }
                      relativeHeight = (leftSleeveHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                    }
                  }
                }
                if ( (row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + torsoHeight))) {
                  if ((col >= (leftSleeveUpperWidth)) && (col < (totalWidth - rightSleeveUpperWidth))) {
                    if (!torsoDuplicate) {
                      //$("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Torso"' + '</div>');
                      if ($("#slit-list-container div:first").text() === lowerShoulders) {
                        $("#slit-list-container div:first").replaceWith('<div class="slit-list-item">' + '"Torso"' + '</div>');
                      }else{
                        $("#slit-list-container").append('<div class="slit-list-item">' + '"Torso"' + '</div>');
                      }
                      relativeHeight = (torsoHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                      //torsoDuplicate = true;
                    }
                  }
                }
                if ( (row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + rightSleeveHeight))) {
                  if ((col < (totalWidth - (inc2 + 1))) && (col >= (leftSleeveUpperWidth + torsoWidth + (inc2 + 1)))) {
                    if (!rightSleeveDuplicate) {
                      if ($("#slit-list-container div:first").text() === lowerShoulders) {
                        $("#slit-list-container div:first").replaceWith('<div class="slit-list-item">' + '"Arm1"' + '</div>');
                      }else{
                        $("#slit-list-container").append('<div class="slit-list-item">' + '"Arm1"' + '</div>');
                      }
                      relativeHeight = (rightSleeveHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                    }
                  }
                }
                if (((neckHeight + upperShoulderHeight) <= row) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (col >= 0) && (col < lowerShoulderWidth)) {
                  if (!lowerShoulderDuplicate) {
                    if ($("#slit-list-container div:first").text() === upperShoulders) {
                      // Replace the first div with the new content
                      $("#slit-list-container div:first").replaceWith('<div class="slit-list-item">' + '"Lower_Shoulders"' + '</div>');
                    }else{
                      $("#slit-list-container").append('<div class="slit-list-item">' + '"Lower_Shoulders"' + '</div>');
                    }
                    relativeHeight = (lowerShoulderHeight + upperShoulderHeight + neckHeight);
                  }
                }
                if ((neckHeight <= row) && (row < (neckHeight + upperShoulderHeight)) && (col >= (leftSleeveUpperWidth - (upperSoulderInc))) && (col < (leftSleeveUpperWidth + torsoWidth + upperSoulderInc))) {
                  if (!upperShoulderDuplicate) {
                    if ($("#slit-list-container div:first").text() === neck) {
                      $("#slit-list-container div:first").replaceWith('<div class="slit-list-item">' + '"Upper_Shoulders"' + '</div>');
                    }else {
                      $("#slit-list-container").append('<div class="slit-list-item">' + '"Upper_Shoulders"' + '</div>');
                    }
                    relativeHeight = (upperShoulderHeight + neckHeight);
                  }
                }
                if (((row < neckHeight) && (col >= (Math.round((totalWidth - neckWidth) / 2) - neckInc)) && (col < (Math.round((totalWidth + neckWidth) / 2) + neckInc)))) {
                  if (!neckDuplicate) {
                    $("#slit-list-container").append('<div class="slit-list-item">' + '"Neck"' + '</div>');
                    relativeHeight = (neckHeight);
                  }
                }

                if (!duplicate) {
                  $("#slit-list-container").append('<div class="slit-list-item">' + `[${row},${col}]` + '</div>')
                }

                //sort by row position
                // var slit_items = $(".slit-list-item").get();
                // slit_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                // $("#slit-list-container").empty().append(slit_items);
              }else if (flapNodes[`${row}-${col}`]) {
                nodeColor = flapNodes[`${row}-${col}`];
                ctx.fillStyle = nodeColor;
                var flapNodeLoc = `[${row},${col}]`;
                var duplicateSectionNameFlap = false;
                //var duplicate = false;

                $(".flap-list-item").each(function () {
                  if ($(this).text() === flapNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === neck)) {
                    neckDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === upperShoulders)) {
                    upperShoulderDuplicate = true;
                  }
                  if (($(this).text() === lowerShoulders)) {
                    lowerShoulderDuplicate = true;
                  }
                  if (($(this).text() === rightSleeve)) {
                    rightSleeveDuplicate = true;
                  }
                  if (($(this).text() === torso)) {
                    torsoDuplicate = true;
                  }
                  if (($(this).text() === leftSleeve)) {
                    leftSleeveDuplicate = true;
                  }
                });

                //add section tag to pocket container
                if ((row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + leftSleeveHeight))) {
                  if ((col <= (leftSleeveUpperWidth - (inc1 + 1))) && (col >= (inc1))) {
                    if (!leftSleeveDuplicate) {
                      if ($("#flap-list-container div:first").text() === lowerShoulders) {
                        $("#flap-list-container div:first").replaceWith('<div class="flap-list-item">' + '"Arm2"' + '</div>');
                      }else{
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Arm2"' + '</div>');
                      }
                      if ($("#Flap-orientation-select").val() === "Side") {
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Side"' + '</div>');
                      }else if ($("#Flap-orientation-select").val() === "Horizontal"){
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Horizontal"' + '</div>');
                      }

                      if ($("#Flap-side-select").val() === "Right") {
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Right"' + '</div>');
                      }else if ($("#Flap-side-select").val() === "Left"){
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Left"' + '</div>');
                      }else if ($("#Flap-side-select").val() === "Both"){
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Both"' + '</div>');
                      }

                      if ($("#Flap-bed-select").val() === "Front") {
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Front"' + '</div>');
                      }else if ($("#Flap-bed-select").val() === "Back"){
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Back"' + '</div>');
                      }else if ($("#Flap-bed-select").val() === "Front-Back"){
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Front_Back"' + '</div>');
                      }

                      var flap_len = $("#flap-length-input").val();
                      $("#flap-list-container").append('<div class="flap-list-item">' + flap_len + '</div>');

                      relativeHeight = (leftSleeveHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                    }
                  }
                }
                if ( (row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + torsoHeight))) {
                  if ((col >= (leftSleeveUpperWidth)) && (col < (totalWidth - rightSleeveUpperWidth))) {
                    if (!torsoDuplicate) {
                      //$("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Torso"' + '</div>');
                      if ($("#flap-list-container div:first").text() === lowerShoulders) {
                        $("#flap-list-container div:first").replaceWith('<div class="flap-list-item">' + '"Torso"' + '</div>');
                      }else{
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Torso"' + '</div>');
                      }
                      relativeHeight = (torsoHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                      //torsoDuplicate = true;
                    }
                  }
                }
                if ( (row >= (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight + rightSleeveHeight))) {
                  if ((col < (totalWidth - (inc2 + 1))) && (col >= (leftSleeveUpperWidth + torsoWidth + (inc2 + 1)))) {
                    if (!rightSleeveDuplicate) {
                      if ($("#flap-list-container div:first").text() === lowerShoulders) {
                        $("#flap-list-container div:first").replaceWith('<div class="flap-list-item">' + '"Arm1"' + '</div>');
                      }else{
                        $("#flap-list-container").append('<div class="flap-list-item">' + '"Arm1"' + '</div>');
                      }
                      relativeHeight = (rightSleeveHeight + lowerShoulderHeight + upperShoulderHeight + neckHeight);
                    }
                  }
                }
                if (((neckHeight + upperShoulderHeight) <= row) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (col >= 0) && (col < lowerShoulderWidth)) {
                  if (!lowerShoulderDuplicate) {
                    if ($("#flap-list-container div:first").text() === upperShoulders) {
                      // Replace the first div with the new content
                      $("#flap-list-container div:first").replaceWith('<div class="flap-list-item">' + '"Lower_Shoulders"' + '</div>');
                    }else{
                      $("#flap-list-container").append('<div class="flap-list-item">' + '"Lower_Shoulders"' + '</div>');
                    }

                    relativeHeight = (lowerShoulderHeight + upperShoulderHeight + neckHeight);
                  }
                }
                if ((neckHeight <= row) && (row < (neckHeight + upperShoulderHeight)) && (col >= (leftSleeveUpperWidth - (upperSoulderInc))) && (col < (leftSleeveUpperWidth + torsoWidth + upperSoulderInc))) {
                  if (!upperShoulderDuplicate) {
                    if ($("#flap-list-container div:first").text() === neck) {
                      $("#flap-list-container div:first").replaceWith('<div class="flap-list-item">' + '"Upper_Shoulders"' + '</div>');
                    }else {
                      $("#flap-list-container").append('<div class="flap-list-item">' + '"Upper_Shoulders"' + '</div>');
                    }
                    relativeHeight = (upperShoulderHeight + neckHeight);
                  }
                }
                if (((row < neckHeight) && (col >= (Math.round((totalWidth - neckWidth) / 2) - neckInc)) && (col < (Math.round((totalWidth + neckWidth) / 2) + neckInc)))) {
                  if (!neckDuplicate) {
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Neck"' + '</div>');
                    relativeHeight = (neckHeight);
                  }
                }


                if (!duplicate) {
                  $("#flap-list-container").append('<div class="flap-list-item">' + `[${row},${col}]` + '</div>')

                  if ($("#Flap-orientation-select").val() === "Side") {
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Side"' + '</div>');
                    if ($("#Flap-side-select").val() === "Right") {
                      $("#flap-list-container").append('<div class="flap-list-item">' + '"Right"' + '</div>');
                    }else if ($("#Flap-side-select").val() === "Left"){
                      $("#flap-list-container").append('<div class="flap-list-item">' + '"Left"' + '</div>');
                    }else if ($("#Flap-side-select").val() === "Both"){
                      $("#flap-list-container").append('<div class="flap-list-item">' + '"Both"' + '</div>');
                    }
                  }else if ($("#Flap-orientation-select").val() === "Horizontal"){
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Horizontal"' + '</div>');
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"None"' + '</div>');
                  }



                  if ($("#Flap-bed-select").val() === "Front") {
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Front"' + '</div>');
                  }else if ($("#Flap-bed-select").val() === "Back"){
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Back"' + '</div>');
                  }else if ($("#Flap-bed-select").val() === "Front-Back"){
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Front_Back"' + '</div>');
                  }

                  var flap_len = $("#flap-length-input").val();
                  $("#flap-list-container").append('<div class="flap-list-item">' + flap_len + '</div>');
                }

                //sort by row position
                // var flap_items = $(".flap-list-item").get();
                // flap_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                // $("#flap-list-container").empty().append(flap_items);
              }else{
                ctx.fillStyle = nodeColor;
              }

              // holeNodes = $("#hole-list-container");
              // if (holeNodes[`${row}-${col}`]) {
              //   let holeNodeColor = colors.holeNodes;
              //   ctx.fillStyle = holeNodeColor;
              // }else{
              //   ctx.fillStyle = nodeColor;
              // }
              // Draw circle (stitch)

              ctx.beginPath();
              ctx.arc(x, y, (nodeSize / 2) * scaleFactor, 0, Math.PI * 2);
              ctx.fill();
              ctx.strokeStyle = "black";
              ctx.lineWidth = 0.3 * scaleFactor;
              ctx.stroke();

            }
            //slope change for neck
            neckInc += 2;
            //slope change for upper shoulders
            if (neckHeight <= row) {
              upperSoulderInc += 1;
            }

            //sleeve slope changes
            if ((neckHeight+upperShoulderHeight+lowerShoulderHeight) <= row) {

              left_sleeve_count = left_sleeve_count + 1;
              if (right_sleeve_count !== 0 && (left_sleeve_count % leftSleeveSlopeInc) === 0) {
                inc1 += 1;
              }
            }
            if ((neckHeight+upperShoulderHeight+lowerShoulderHeight) <= row) {
              right_sleeve_count = right_sleeve_count + 1;
              if(right_sleeve_count !== 0 && ((right_sleeve_count % rightSleeveSlopeInc) === 0)){
                inc2 += 1;
              }
            }
            //var items = $(".hole-list-item").get();
            // items.sort(function(a, b) {
            //   return $(a).text().localeCompare($(b).text());
            // });
            // $("#hole-list-container").empty().append(items);
            // $("#full-af-list-container").append('<div class="full-af-list-item">' + `[${$(".hole-list-item").get()}]` + '</div>');
          }
          //var holeAF = $(".hole-list-container").get();
          //$("#full-af-list-container").append('<div class="full-af-list-item">' + `[${$(".hole-list-item").get()}]` + '</div>');


          // var duplicateAF = false;
          // $(".full-af-list-item").each(function () {
          //   if ($(this).text() === holeAF) {
          //     duplicateAF = true;
          //     // return false; // Break loop
          //   }
          // });
          // if (!duplicate) {

          // }

        }
        // $(".pocket-list-item").each(function () {
        //   if ($(this).text() === pocketNodeLoc) {
        //     duplicate = true;
        //     // return false; // Break loop
        //   }
        // });
        //$(".hole-list-item").each(function () {
          //var holeAF = $(this).text();

        //});

        //buttons for printing af dims
        $("#print-all-afs").click(function() {
          //var holes = $(".hole-list-item").get();
        //.append($("#source").clone());
          //copy af conatiners over to full af list for garment
          var torso_circum = $("#torso-circumference-input").val();
          var torso_len = $("#torso-length-input").val();
          var left_arm_len = $("#left-arm-length-input").val();
          var right_arm_len = $("#right-arm-length-input").val();

          // Compact Measurements
          var sweater_measurements = {
            torso_circum: torso_circum,
            torso_len: torso_len,
            left_arm_len: left_arm_len,
            right_arm_len: right_arm_len
          };

          if (holeNodes) {
            $("#final-af-list-container").append('<div class="final-af-list-item">' + `[${$("#hole-list-container").clone()}]` + '</div>');
          }
          if (pocketNodes) {
            $("#final-af-list-container").append('<div class="final-af-list-item">' + `[${$("#pocket-list-container").clone()}]` + '</div>');
          }
          if (slitNodes) {
            $("#final-af-list-container").append('<div class="final-af-list-item">' + `[${$("#slit-list-container").clone()}]` + '</div>');
          }
          if (flapNodes) {
            $("#final-af-list-container").append('<div class="final-af-list-item">' + `[${$("#flap-list-container").clone()}]` + '</div>');
          }
          var holes = [];
          var pockets = [];
          var slits = [];
          var flaps = [];
          var temp;
          $(".final-af-list-item").each(function() {
            $(".hole-list-item").each(function() {
              holes.push($(this).text());
            });
            $(".pocket-list-item").each(function() {
              pockets.push($(this).text());
            });
            $(".slit-list-item").each(function() {
              slits.push($(this).text());
            });
            $(".flap-list-item").each(function() {
              flaps.push($(this).text());
            });
          });

          let af_type = [];
          let af_tag = "none";
          if(holes.length > 0){
            af_type = holes;
            af_tag = '"Hole"';
          }else if(pockets.length > 0){
            af_type = pockets;
            af_tag = '"Pocket"';
          }else if(flaps.length > 0){
            af_type = flaps;
            af_tag = '"Flap"';
          }else if(slits.length > 0){
            af_type = slits;
            af_tag = '"Slit"';
          }

          for (let num = 1; num < af_type.length; num++) {
            let node = af_type[num];
            // Parse the stringified node into an array
            let nodeArray = JSON.parse(node);
            // Modify the first element of the array based on relativeHeight
            nodeArray[0] = relativeHeight - nodeArray[0];
            // Convert the array back into a string and update the holes array
            af_type[num] = JSON.stringify(nodeArray);
          }
          //sort the holes array (excluding the first string element)
          let uniqueAF = [];
          af_type.slice(1).forEach(item => {
            if (!uniqueAF.includes(item)) {
              uniqueAF.push(item);
            }
          });

// Sort the holes array in ascending order by the first element, and then by the second element
          let sortedAF = uniqueAF.sort((a, b) => {
            // Parse each element back into an array for sorting
            let arrA = JSON.parse(a);
            let arrB = JSON.parse(b);
            // First compare by the first element
            if (arrA[0] !== arrB[0]) {
              return arrA[0] - arrB[0];  // Ascending order for the first element
            }
            // If the first elements are equal, compare by the second element
            return arrA[1] - arrB[1];  // Ascending order for the second element
          });

// Reinsert the first string element at the beginning of the sorted array

// Reinsert the first string element at the beginning of the sorted array
          sortedAF.unshift(af_tag);
          sortedAF.unshift(af_type[0]);
          sortedAF.pop();
          full_af_list.push('[' + sortedAF + ']');
          //console.log(full_af_list);
          //   return $(a).text().localeCompare($(b).text());
          // })
          //sort by row position

          // holes.sort((a, b) => {
          //   // Parse each element back into an array for sorting
          //   let arrA = JSON.parse(a);
          //   let arrB = JSON.parse(b);
          //   if (Array.isArray(arrA) && Array.isArray(arrB)) {
          //     return arrA[0] - arrB[0];
          //   }
          //   return 0;
          //   // Compare the first element of each array for ascending order
          //   //return arrA[0] - arrB[0];
          // });
          // for (let num = 1; num < holes.length; num++) {
          //   let node = holes[num];
          //   let nodePos = node.split('[', ",", ']');
          //   nodePos[0] = relativeHeight;//- parseInt(nodePos[0]));
          //   holes[num] = nodePos.join('[', ",", ']');
          // }
          $("#output-afs-loc").text('[' + full_af_list + '] '); //+ "[" + pockets.join(", ") + "]");
          $("#hole-list-container").empty();
          holeNodes = {};
          $("#pocket-list-container").empty();
          pocketNodes = {};
          $("#slit-list-container").empty();
          slitNodes = {};
          $("#flap-list-container").empty();
          flapNodes = {};
          //Send data to Python server using AJAX
          var garment_and_af_measurements = {
            garment_data: sweater_measurements,
            af_data: full_af_list,
            garment_type: "Sweater",
          };

          $.ajax({
            url: "http://127.0.0.1:5000/af_inputs",  // Flask endpoint
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify(garment_and_af_measurements),
            success: function (response) {
              console.log("Response from Python:", response);
            },
            error: function (error) {
              console.error("Error:", error);
            }
          });
        });
        $("#print-hole-value").click(function() {
          var items = [];
          $(".hole-list-item").each(function() {
            items.push($(this).text());
          });
          $("#output-hole-loc").text("List Items: " + items.join(", "));
        });
        $("#print-pocket-value").click(function() {
          var items = [];
          $(".pocket-list-item").each(function() {
            items.push($(this).text());
          });
          $("#output-pocket-loc").text("List Items: " + items.join(", "));
        });
        $("#print-slit-value").click(function() {
          var items = [];
          $(".slit-list-item").each(function() {
            items.push($(this).text());
          });
          $("#output-slit-loc").text("List Items: " + items.join(", "));
        });
        $("#print-flap-value").click(function() {
          var items = [];
          $(".flap-list-item").each(function() {
            items.push($(this).text());
          });
          $("#output-slit-loc").text("List Items: " + items.join(", "));
        });

        // $("#print-value").click(function() {
        //   // var lastInput = afNodes;
        //   $("#output-af-loc").text("AF Node Values: " + holeNodes);
        // });

        $("#AF-select").selectmenu();

        // For selecting which AF to add
        $("#AF-select").on("selectmenuchange", function () {
          var selectedOption = $(this).val();

          // Show or hide elements based on the selected option
          if (selectedOption === "Hole") {
            $("#hole-input-control").show();

            $("#pocket-input-control").hide();
            $("#slit-input-control").hide();
            $("#flap-input-control").hide();

          }else if (selectedOption === "Pocket") {
            // Apply new colors when mouse is clicked
            $("#pocket-input-control").show();

            $("#hole-input-control").hide();
            $("#slit-input-control").hide();
            $("#flap-input-control").hide();
          }else if (selectedOption === "Slit") {
          // Apply new colors when mouse is clicked
            $("#slit-input-control").show();

            $("#pocket-input-control").hide();
            $("#hole-input-control").hide();
            $("#flap-input-control").hide();

          }else if (selectedOption === "Flap") {
          // Apply new colors when mouse is clicked
            $("#flap-input-control").show();

            $("#pocket-input-control").hide();
            $("#slit-input-control").hide();
            $("#hole-input-control").hide();
          }
        });

        //button to apply selected af to garment
        $("#applyHoleColor").click(function () {
          // if(colors.afNodes === )
          // $("#setGroupColor").click(function () {
            currentGroupColor = $("#hole-nodeColor").val();
          //
            Object.keys(afNodes).forEach(nodeKey => {

              if (afNodes[nodeKey] === "#FF0000") {
                // if ((afNodes[nodeKey] === "#0022ff") && $("#hole-list-container").isEmpty()) {
                // $("#final-af-list-container").append('<div class="hole-list-item">' + 'Neck' + '</div>')
                // }
                afNodes[nodeKey] = currentGroupColor;
                holeNodes[nodeKey] = currentGroupColor;
              }

            });

          //
          //   drawSweater();
          // });

          // colors.afNodes = $("#hole-nodeColor").val();
          // holeNodes = afNodes;
          // $("#hole-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container").empty();
          // colors.afNodes = "#FF0000";
          // afNodes.empty();
          drawSweater();
        });
        $("#applyPocketColor").click(function () {
          currentGroupColor = $("#pocket-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            //afNodes[nodeKey] = currentGroupColor;
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              pocketNodes[nodeKey] = currentGroupColor;
            }
          });

          //$("#pocket-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container").empty();

          // afNodes.empty();
          drawSweater();
        });
        $("#applySlitColors").click(function () {
          currentGroupColor = $("#slit-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              slitNodes[nodeKey] = currentGroupColor;
            }
          });

          //$("#slit-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container").empty();

          // afNodes.empty();
          drawSweater();
        });
        $("#applyFlapColors").click(function () {
          currentGroupColor = $("#flap-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              flapNodes[nodeKey] = currentGroupColor;
              }
          });

          //$("#flap-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container").empty();

          // afNodes.empty();
          drawSweater();
        });
        // Initial Draw
        adjustCanvasSize();
        drawSweater();

        // Mouse wheel zoom functionality
        $('#sweaterCanvas').on('wheel', function (e) {
          e.preventDefault();
          if (e.originalEvent.deltaY < 0) {
            scaleFactor *= 1.1;  // Zoom in
          } else {
            scaleFactor *= 0.9;  // Zoom out
          }

          // Prevent zooming too much in or out
          if (scaleFactor < 0.1) scaleFactor = 0.1;
          if (scaleFactor > 5) scaleFactor = 5;

          adjustCanvasSize();
          drawSweater();
        });

        // Track mouse dragging to select nodes
        let isDragging = false;
        let lastMousePos = { x: 0, y: 0 };

        //start dragging or select a node with mouse
        $('#sweaterCanvas').on('mousedown', function (e) {
          // Get mouse position on canvas
          let mouseX = e.offsetX;
          let mouseY = e.offsetY;

          // Correct the position for zoom scaling
          mouseX /= scaleFactor;
          mouseY /= scaleFactor;

          // Calculate which node is under the mouse
          let col = Math.floor((mouseX - 10) / (nodeSize + gap));
          let row = Math.floor((mouseY - 10) / (nodeSize + gap));

          // Check if the click is inside the sweater area
          if (row >= 0 && row < totalHeight && col >= 0 && col < totalWidth) {
            let key = `${row}-${col}`;

            if (!e.shiftKey) {
              if (afNodes[key]) {
                delete afNodes[key];
              } else {
                afNodes[key] = currentGroupColor;
              }
            } else {
              afNodes[key] = currentGroupColor;
            }
            // let key = `${row}-${col}`;
            //
            // if (!e.shiftKey) {
            //   // Toggle the selection of the node when clicking without shift
            //   if (afNodes[key]) {
            //     delete afNodes[key];
            //   } else {
            //     afNodes[key] = true;
            //   }
            // } else {
            //   // Always select the node if shift is pressed
            //   afNodes[key] = true;
            // }
          }

          // Start the drag
          isDragging = true;
          lastMousePos = { x: e.offsetX, y: e.offsetY };

          drawSweater();
        });

        // select nodes while dragging mouse
        $('#sweaterCanvas').on('mousemove', function (e) {
          if (isDragging) {
            // Get mouse position on garment
            let mouseX = e.offsetX;
            let mouseY = e.offsetY;

            //Correct the position for zoom scaling
            mouseX /= scaleFactor;
            mouseY /= scaleFactor;

            // Calculate which node is under the mouse
            let col = Math.floor((mouseX - 10) / (nodeSize + gap));
            let row = Math.floor((mouseY - 10) / (nodeSize + gap));

            // Check if the mouse is inside the sweater area
            if (row >= 0 && row < totalHeight && col >= 0 && col < totalWidth) {
              let key = `${row}-${col}`;
              if (!afNodes[key]) {
                afNodes[key] = currentGroupColor;
              }
              // let key = `${row}-${col}`;
              // if (!afNodes[key]) {
              //   afNodes[key] = true; // Select the node
              // }
            }

            drawSweater();
          }
        });

        //end the dragging
        $('#sweaterCanvas').on('mouseup', function () {
          isDragging = false;
        });
      });

      $("#compile-sock-button").click(function () {
        // Collect measurements for sock garment
        var foot_circum = $("#foot-circumference-input").val();
        var foot_len = $("#foot-length-input").val();
        var sock_height = $("#sock-height-input").val();

        // Compact Measurements
        var sock_measurements = {
          foot_circum: foot_circum,
          foot_len: foot_len,
          sock_height: sock_height
        };


        let gauge = 12;
        let vert_gauge = 18;
        //let K = (foot_len * 0.9 * vert_gauge);
        let footWidth = Math.round((gauge * foot_circum * 0.8)/2);//160;
        let footHeight = Math.round(vert_gauge * foot_len * 0.9);
        let legHeight = Math.round(vert_gauge * sock_height * 0.9);
        let toeBoxHeight = Math.round(footWidth/4);
        let toeBoxWidth = Math.round(footWidth/2);
        //let heelHeight = Math.round(footHeight*0.25*vert_gauge); //only for back side?
        //let footHeight = Math.round(K-heelHeight);

        let totalWidth = footWidth; //+ leftSleeveUpperWidth + rightSleeveUpperWidth;
        let totalHeight = footHeight + legHeight + 2;
        let nodeSize = 5;  // Each stitch (smaller for large grids)
        let gap = 1;       // Space between nodes

        let canvas = document.getElementById("sockCanvas");
        let ctx = canvas.getContext("2d");

        // Canvas scale factor (used for zooming)
        let scaleFactor = 1;

        let colors = {
          foot: "#0022ff",
          heel: "#2d4efa",
          leg: "#637df8",
          // leftSleeve: "#93a9f6",
          // rightSleeve: "#93a9f6",
          // torso: "#93a9f6",
          afNodes: "#FF0000",
          holeNodes: "#ff6a00",
          pocketNodes: "#08ff00",
          flapNodes: "#000000",
          slitNodes: "#a600ff",
        };

        let afNodes = {}; // To store selected nodes
        let holeNodes = {};
        let pocketNodes = {};
        let flapNodes = {};
        let slitNodes = {};
        let currentGroupColor = "#FF0000";

        var duplicateSectionName = false;

        // Adjust canvas size dynamically
        function adjustCanvasSize() {
          canvas.width = (totalWidth * (nodeSize + gap)) * scaleFactor + 20;
          canvas.height = (totalHeight * (nodeSize + gap)) * scaleFactor + 20;
        }

        // Send data to Python server using AJAX
        $.ajax({
          url: "http://127.0.0.1:5000/sock_inputs",  // Flask endpoint
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify(sock_measurements),
          success: function (response) {
            console.log("Response from Python:", response);
          },
          error: function (error) {
            console.error("Error:", error);
          }
        });

        // Draw the sweater graph with the current scale
        function drawSock() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          let toeBoxInc = 0;
          // let upperSoulderInc = 0;
          // let inc1 = 0;
          // let inc2 = 0;
          // let left_sleeve_count = 0;
          // let right_sleeve_count = 0;

          currentGroupColor = "#FF0000";
          // Adjust for zooming (scaleFactor is applied here)

          for (let row = 0; row < totalHeight; row++) {

            for (let col = 0; col < totalWidth; col++) {
              let x = (col * (nodeSize + gap) + 10) * scaleFactor;
              let y = (row * (nodeSize + gap) + 10) * scaleFactor;
              let nodeColor = "white"; // Default -> empty node

              // Neck to shoulders (width increase of two nodes per row)
              // if ((row < neckHeight) && (col >= (Math.round((totalWidth - neckWidth) / 2) - neckInc)) && (col < (Math.round((totalWidth + neckWidth) / 2) + neckInc))) {
              //   //print(neckInc);
              //   nodeColor = colors.neck;
              // }
              //upper shoulders (width increase of one node per row)
              // else if ((neckHeight <= row) && (row < (neckHeight + upperShoulderHeight)) && (col >= (leftSleeveUpperWidth - (upperSoulderInc))) && (col < (leftSleeveUpperWidth + torsoWidth + upperSoulderInc))) {
              //   nodeColor = colors.upperShoulder;
              // }
              //lower shoulders (constant width)
              //else if (((neckHeight + upperShoulderHeight) <= row) && (row < (neckHeight + upperShoulderHeight + lowerShoulderHeight)) && (col >= 0) && (col < lowerShoulderWidth)) {
              //foot portion
              if ((row < toeBoxHeight) && (col >= (Math.round((totalWidth - toeBoxWidth) / 2) - toeBoxInc)) && (col < (Math.round((totalWidth + toeBoxWidth) / 2) + toeBoxInc))) {
                //print(neckInc);
                nodeColor = colors.foot;
              }
              if ((row >= toeBoxHeight) && (row < (footHeight+toeBoxHeight)) && (col >= 0) && (col < footWidth)) {
                nodeColor = colors.foot;
              }
              if ((row >= (toeBoxHeight+footHeight)) && (row < (footHeight+toeBoxHeight+legHeight)) && (col >= 0) && (col < footWidth)) {
                nodeColor = colors.leg;
              }

              // if(col === 0){
              //     nodeColor = colors.testColor;
              // }

              // If the node is selected, update the color for selected AF

              if (afNodes[`${row}-${col}`]) {
                nodeColor = afNodes[`${row}-${col}`];
                var afNodeLoc = `[${row},${col}]`;
                var duplicate = false;

                $(".af-list-item-sock").each(function () {
                  if ($(this).text() === afNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                });
                if (!duplicate) {
                  $("#af-list-container-sock").append('<div class="af-list-item-sock">' + `[${row},${col}]` + '</div>')
                }
              }

              var foot = '"Foot"';
              var heel = '"Heel"';
              var leg = '"Leg"';
              // var leftSleeve = '"Arm2"'; //left sleeve
              // var rightSleeve = '"Arm1"'; //right sleeve
              // var torso = '"Torso"';

              var footDuplicate = false;
              var heelDuplicate = false;
              var legDuplicate = false;
              // var lowerShoulderDuplicate = false;
              // var upperShoulderDuplicate = false;
              // var neckDuplicate = false;


              // ctx.fillStyle = nodeColor;
              if (holeNodes[`${row}-${col}`]) {
                // nodeColor = holeNodes[`${row}-${col}`];
                // ctx.fillStyle = nodeColor;
                ctx.fillStyle = holeNodes[`${row}-${col}`];
                var holeNodeLoc = `[${row},${col}]`;
                //var duplicate = false;

                $(".hole-list-item-sock").each(function () {
                  if (($(this).text() === holeNodeLoc)) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === foot)) {
                    footDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === heel)) {
                    heelDuplicate = true;
                  }
                  if (($(this).text() === leg)) {
                    legDuplicate = true;
                  }
                });

                if (((toeBoxHeight + footHeight) <= row) && (row < (toeBoxHeight + footHeight + legHeight)) && (col >= 0) && (col < footWidth)) {
                  if (!legDuplicate) {
                    if ($("#hole-list-container-sock div:first").text() === foot) {
                      // Replace the first div with the new content
                      $("#hole-list-container-sock div:first").replaceWith('<div class="hole-list-item-sock">' + '"Leg"' + '</div>');
                    } else {
                      $("#hole-list-container-sock").append('<div class="hole-list-item-sock">' + '"Leg"' + '</div>');
                    }
                    relativeHeight = (toeBoxHeight + footHeight + legHeight);
                  }
                }
                if ((toeBoxHeight <= row) && (row < (toeBoxHeight + footHeight)) && (col >= 0) && (col < footWidth)) {
                  if (!footDuplicate) {
                    // if ($("#hole-list-container div:first").text() === t) {
                    //   $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Upper_Shoulders"' + '</div>');
                    // } else {
                      $("#hole-list-container-sock").append('<div class="hole-list-item-sock">' + '"Foot"' + '</div>');
                    // }
                    relativeHeight = (toeBoxHeight + footHeight);
                  }
                }
                if (((row < toeBoxHeight) && (col >= (Math.round((totalWidth - toeBoxWidth) / 2) - toeBoxInc)) && (col < (Math.round((totalWidth + toeBoxWidth) / 2) + toeBoxInc)))) {
                  if (!footDuplicate) {
                    $("#hole-list-container-sock").append('<div class="hole-list-item-sock">' + '"Foot"' + '</div>');
                    relativeHeight = (toeBoxHeight + footHeight);
                  }
                }


                //add needle locations
                if (!duplicate && (afNodes[`${row}-${col}`] === colors.holeNodes)) {
                  $("#hole-list-container-sock").append('<div class="hole-list-item-sock">' + `[${row},${col}]` + '</div>');
                }

              } else if (pocketNodes[`${row}-${col}`]) {
                ctx.fillStyle = pocketNodes[`${row}-${col}`];
                var pocketNodeLoc = `[${row},${col}]`;
                var duplicateSectionNamePocket = false;
                //var duplicate = false;

                $(".pocket-list-item-sock").each(function () {
                  if ($(this).text() === pocketNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === foot)) {
                    footDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === heel)) {
                    heelDuplicate = true;
                  }
                  if (($(this).text() === leg)) {
                    legDuplicate = true;
                  }
                });

                //add section tag to pocket container
                if (((toeBoxHeight + footHeight) <= row) && (row < (toeBoxHeight + footHeight + legHeight)) && (col >= 0) && (col < footWidth)) {
                  if (!legDuplicate) {
                    if ($("#pocket-list-container-sock div:first").text() === foot) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-sock div:first").replaceWith('<div class="pocket-list-item-sock">' + '"Leg"' + '</div>');
                    } else {
                      $("#pocket-list-container-sock").append('<div class="pocket-list-item-sock">' + '"Leg"' + '</div>');
                    }
                    relativeHeight = (toeBoxHeight + footHeight + legHeight);
                  }
                }
                if ((toeBoxHeight <= row) && (row < (toeBoxHeight + footHeight)) && (col >= 0) && (col < footWidth)) {
                  if (!footDuplicate) {
                    // if ($("#hole-list-container div:first").text() === t) {
                    //   $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Upper_Shoulders"' + '</div>');
                    // } else {
                    $("#pocket-list-container-sock").append('<div class="pocket-list-item-sock">' + '"Foot"' + '</div>');
                    // }
                    relativeHeight = (toeBoxHeight + footHeight);
                  }
                }
                if (((row < toeBoxHeight) && (col >= (Math.round((totalWidth - toeBoxWidth) / 2) - toeBoxInc)) && (col < (Math.round((totalWidth + toeBoxWidth) / 2) + toeBoxInc)))) {
                  if (!footDuplicate) {
                    $("#pocket-list-container-sock").append('<div class="pocket-list-item-sock">' + '"Foot"' + '</div>');
                    relativeHeight = (toeBoxHeight + footHeight);
                  }
                }

                if (!duplicate) {
                  $("#pocket-list-container-sock").append('<div class="pocket-list-item-sock">' + `[${row},${col}]` + '</div>')
                }
                //sort by row position
                // var pocket_items = $(".pocket-list-item").get();
                // pocket_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                //$("#pocket-list-container").empty().append(pocket_items);
              } else if (slitNodes[`${row}-${col}`]) {
                nodeColor = slitNodes[`${row}-${col}`];
                ctx.fillStyle = nodeColor;
                var slitNodeLoc = `[${row},${col}]`;
                var duplicateSectionNameSlit = false;
                //var duplicate = false;

                $(".slit-list-item-sock").each(function () {
                  if ($(this).text() === slitNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === foot)) {
                    footDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === heel)) {
                    heelDuplicate = true;
                  }
                  if (($(this).text() === leg)) {
                    legDuplicate = true;
                  }
                });

                //add section tag to slit container
                if (((toeBoxHeight + footHeight) <= row) && (row < (toeBoxHeight + footHeight + legHeight)) && (col >= 0) && (col < footWidth)) {
                  if (!legDuplicate) {
                    if ($("#slit-list-container-sock div:first").text() === foot) {
                      // Replace the first div with the new content
                      $("#slit-list-container-sock div:first").replaceWith('<div class="slit-list-item-sock">' + '"Leg"' + '</div>');
                    } else {
                      $("#slit-list-container-sock").append('<div class="slit-list-item-sock">' + '"Leg"' + '</div>');
                    }
                    relativeHeight = (toeBoxHeight + footHeight + legHeight);
                  }
                }
                if ((toeBoxHeight <= row) && (row < (toeBoxHeight + footHeight)) && (col >= 0) && (col < footWidth)) {
                  if (!footDuplicate) {
                    // if ($("#hole-list-container div:first").text() === t) {
                    //   $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Upper_Shoulders"' + '</div>');
                    // } else {
                    $("#slit-list-container-sock").append('<div class="slit-list-item-sock">' + '"Foot"' + '</div>');
                    // }
                    relativeHeight = (toeBoxHeight + footHeight);
                  }
                }
                if (((row < toeBoxHeight) && (col >= (Math.round((totalWidth - toeBoxWidth) / 2) - toeBoxInc)) && (col < (Math.round((totalWidth + toeBoxWidth) / 2) + toeBoxInc)))) {
                  if (!footDuplicate) {
                    $("#slit-list-container-sock").append('<div class="slit-list-item-sock">' + '"Foot"' + '</div>');
                    relativeHeight = (toeBoxHeight + footHeight);
                  }
                }

                if (!duplicate) {
                  $("#slit-list-container-sock").append('<div class="slit-list-item-sock">' + `[${row},${col}]` + '</div>')
                }

                //sort by row position
                // var slit_items = $(".slit-list-item").get();
                // slit_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                // $("#slit-list-container").empty().append(slit_items);
              } else if (flapNodes[`${row}-${col}`]) {
                nodeColor = flapNodes[`${row}-${col}`];
                ctx.fillStyle = nodeColor;
                var flapNodeLoc = `[${row},${col}]`;
                var duplicateSectionNameFlap = false;
                //var duplicate = false;

                $(".flap-list-item-sock").each(function () {
                  if ($(this).text() === flapNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === foot)) {
                    footDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === heel)) {
                    heelDuplicate = true;
                  }
                  if (($(this).text() === leg)) {
                    legDuplicate = true;
                  }
                });

                //add section tag to pocket container
                if (((toeBoxHeight + footHeight) <= row) && (row < (toeBoxHeight + footHeight + legHeight)) && (col >= 0) && (col < footWidth)) {
                  if (!legDuplicate) {
                    if ($("#flap-list-container-sock div:first").text() === foot) {
                      // Replace the first div with the new content
                      $("#flap-list-container-sock div:first").replaceWith('<div class="flap-list-item-sock">' + '"Leg"' + '</div>');
                    } else {
                      $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Leg"' + '</div>');
                    }
                    relativeHeight = (toeBoxHeight + footHeight + legHeight);
                  }
                }
                if ((toeBoxHeight <= row) && (row < (toeBoxHeight + footHeight)) && (col >= 0) && (col < footWidth)) {
                  if (!footDuplicate) {
                    // if ($("#hole-list-container div:first").text() === t) {
                    //   $("#hole-list-container div:first").replaceWith('<div class="hole-list-item">' + '"Upper_Shoulders"' + '</div>');
                    // } else {
                    $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Foot"' + '</div>');
                    // }
                    relativeHeight = (toeBoxHeight + footHeight);
                  }
                }
                if (((row < toeBoxHeight) && (col >= (Math.round((totalWidth - toeBoxWidth) / 2) - toeBoxInc)) && (col < (Math.round((totalWidth + toeBoxWidth) / 2) + toeBoxInc)))) {
                  if (!footDuplicate) {
                    $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Foot"' + '</div>');
                    relativeHeight = (toeBoxHeight + footHeight);
                  }
                }


                if (!duplicate) {
                  $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + `[${row},${col}]` + '</div>')

                  if ($("#Flap-orientation-select").val() === "Side") {
                    $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Side"' + '</div>');
                    if ($("#Flap-side-select").val() === "Right") {
                      $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Right"' + '</div>');
                    }else if ($("#Flap-side-select").val() === "Left"){
                      $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Left"' + '</div>');
                    }else if ($("#Flap-side-select").val() === "Both"){
                      $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Both"' + '</div>');
                    }
                  }else if ($("#Flap-orientation-select").val() === "Horizontal"){
                    $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Horizontal"' + '</div>');
                    $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"None"' + '</div>');
                  }



                  if ($("#Flap-bed-select").val() === "Front") {
                    $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Front"' + '</div>');
                  }else if ($("#Flap-bed-select").val() === "Back"){
                    $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Back"' + '</div>');
                  }else if ($("#Flap-bed-select").val() === "Front-Back"){
                    $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + '"Front_Back"' + '</div>');
                  }

                  var flap_len = $("#flap-length-input").val();
                  $("#flap-list-container-sock").append('<div class="flap-list-item-sock">' + flap_len + '</div>');
                }

                //sort by row position
                // var flap_items = $(".flap-list-item").get();
                // flap_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                // $("#flap-list-container").empty().append(flap_items);
              } else {
                ctx.fillStyle = nodeColor;
              }

              // holeNodes = $("#hole-list-container");
              // if (holeNodes[`${row}-${col}`]) {
              //   let holeNodeColor = colors.holeNodes;
              //   ctx.fillStyle = holeNodeColor;
              // }else{
              //   ctx.fillStyle = nodeColor;
              // }
              // Draw circle (stitch)

              ctx.beginPath();
              ctx.arc(x, y, (nodeSize / 2) * scaleFactor, 0, Math.PI * 2);
              ctx.fill();
              ctx.strokeStyle = "black";
              ctx.lineWidth = 0.3 * scaleFactor;
              ctx.stroke();

            }
            //slope change for toe box
            toeBoxInc += 1;

          }
        }
        //buttons for printing af dims
        $("#print-all-afs-sock").click(function() {
          //var holes = $(".hole-list-item").get();
          //.append($("#source").clone());
          //copy af conatiners over to full af list for garment
          var foot_circum = $("#foot-circumference-input").val();
          var foot_len = $("#foot-length-input").val();
          var sock_height = $("#sock-height-input").val();

          // Compact Measurements
          var sock_measurements = {
            foot_circum: foot_circum,
            foot_len: foot_len,
            sock_height: sock_height
          };

          if (holeNodes) {
            $("#final-af-list-container-sock").append('<div class="final-af-list-item-sock">' + `[${$("#hole-list-container-sock").clone()}]` + '</div>');
          }
          if (pocketNodes) {
            $("#final-af-list-container-sock").append('<div class="final-af-list-item-sock">' + `[${$("#pocket-list-container-sock").clone()}]` + '</div>');
          }
          if (slitNodes) {
            $("#final-af-list-container-sock").append('<div class="final-af-list-item-sock">' + `[${$("#slit-list-container-sock").clone()}]` + '</div>');
          }
          if (flapNodes) {
            $("#final-af-list-container-sock").append('<div class="final-af-list-item-sock">' + `[${$("#flap-list-container-sock").clone()}]` + '</div>');
          }
          var holes = [];
          var pockets = [];
          var slits = [];
          var flaps = [];
          var temp;
          $(".final-af-list-item-sock").each(function() {
            $(".hole-list-item-sock").each(function() {
              holes.push($(this).text());
            });
            $(".pocket-list-item-sock").each(function() {
              pockets.push($(this).text());
            });
            $(".slit-list-item-sock").each(function() {
              slits.push($(this).text());
            });
            $(".flap-list-item-sock").each(function() {
              flaps.push($(this).text());
            });
          });

          let af_type = [];
          let af_tag = "none";
          if(holes.length > 0){
            af_type = holes;
            af_tag = '"Hole"';
          }else if(pockets.length > 0){
            af_type = pockets;
            af_tag = '"Pocket"';
          }else if(flaps.length > 0){
            af_type = flaps;
            af_tag = '"Flap"';
          }else if(slits.length > 0){
            af_type = slits;
            af_tag = '"Slit"';
          }

          for (let num = 1; num < af_type.length; num++) {
            let node = af_type[num];
            // Parse the stringified node into an array
            let nodeArray = JSON.parse(node);
            // Modify the first element of the array based on relativeHeight
            nodeArray[0] = relativeHeight - nodeArray[0];
            // Convert the array back into a string and update the holes array
            af_type[num] = JSON.stringify(nodeArray);
          }
          //sort the holes array (excluding the first string element)
          let uniqueAF = [];
          af_type.slice(1).forEach(item => {
            if (!uniqueAF.includes(item)) {
              uniqueAF.push(item);
            }
          });

// Sort the holes array in ascending order by the first element, and then by the second element
          let sortedAF = uniqueAF.sort((a, b) => {
            // Parse each element back into an array for sorting
            let arrA = JSON.parse(a);
            let arrB = JSON.parse(b);
            // First compare by the first element
            if (arrA[0] !== arrB[0]) {
              return arrA[0] - arrB[0];  // Ascending order for the first element
            }
            // If the first elements are equal, compare by the second element
            return arrA[1] - arrB[1];  // Ascending order for the second element
          });

// Reinsert the first string element at the beginning of the sorted array

// Reinsert the first string element at the beginning of the sorted array
          sortedAF.unshift(af_tag);
          sortedAF.unshift(af_type[0]);
          sortedAF.pop();
          full_af_list_sock.push('[' + sortedAF + ']');
          //console.log(full_af_list);
          //   return $(a).text().localeCompare($(b).text());
          // })
          //sort by row position

          // holes.sort((a, b) => {
          //   // Parse each element back into an array for sorting
          //   let arrA = JSON.parse(a);
          //   let arrB = JSON.parse(b);
          //   if (Array.isArray(arrA) && Array.isArray(arrB)) {
          //     return arrA[0] - arrB[0];
          //   }
          //   return 0;
          //   // Compare the first element of each array for ascending order
          //   //return arrA[0] - arrB[0];
          // });
          // for (let num = 1; num < holes.length; num++) {
          //   let node = holes[num];
          //   let nodePos = node.split('[', ",", ']');
          //   nodePos[0] = relativeHeight;//- parseInt(nodePos[0]));
          //   holes[num] = nodePos.join('[', ",", ']');
          // }
          $("#output-afs-loc-sock").text('[' + full_af_list_sock + '] '); //+ "[" + pockets.join(", ") + "]");
          $("#hole-list-container-sock").empty();
          holeNodes = {};
          $("#pocket-list-container-sock").empty();
          pocketNodes = {};
          $("#slit-list-container-sock").empty();
          slitNodes = {};
          $("#flap-list-container-sock").empty();
          flapNodes = {};
          // Send data to Python server using AJAX
          var garment_and_af_measurements = {
            garment_data: sock_measurements,
            af_data: full_af_list_sock,
            garment_type: "Sock",
          };

          $.ajax({
            url: "http://127.0.0.1:5000/af_inputs",  // Flask endpoint
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify(garment_and_af_measurements),
            success: function (response) {
              console.log("Response from Python:", response);
            },
            error: function (error) {
              console.error("Error:", error);
            }
          });
        });
        $("#print-hole-value-sock").click(function() {
          var items = [];
          $(".hole-list-item-sock").each(function() {
            items.push($(this).text());
          });
          $("#output-hole-loc-sock").text("List Items: " + items.join(", "));
        });
        $("#print-pocket-value-sock").click(function() {
          var items = [];
          $(".pocket-list-item-sock").each(function() {
            items.push($(this).text());
          });
          $("#output-pocket-loc-sock").text("List Items: " + items.join(", "));
        });
        $("#print-slit-value-sock").click(function() {
          var items = [];
          $(".slit-list-item-sock").each(function() {
            items.push($(this).text());
          });
          $("#output-slit-loc-sock").text("List Items: " + items.join(", "));
        });
        $("#print-flap-value-sock").click(function() {
          var items = [];
          $(".flap-list-item-sock").each(function() {
            items.push($(this).text());
          });
          $("#output-slit-loc-sock").text("List Items: " + items.join(", "));
        });

        // $("#print-value").click(function() {
        //   // var lastInput = afNodes;
        //   $("#output-af-loc").text("AF Node Values: " + holeNodes);
        // });

        $("#AF-select").selectmenu();

        // For selecting which AF to add
        $("#AF-select").on("selectmenuchange", function () {
          var selectedOption = $(this).val();

          // Show or hide elements based on the selected option
          if (selectedOption === "Hole") {
            $("#hole-input-control").show();

            $("#pocket-input-control").hide();
            $("#slit-input-control").hide();
            $("#flap-input-control").hide();

          }else if (selectedOption === "Pocket") {
            // Apply new colors when mouse is clicked
            $("#pocket-input-control").show();

            $("#hole-input-control").hide();
            $("#slit-input-control").hide();
            $("#flap-input-control").hide();
          }else if (selectedOption === "Slit") {
            // Apply new colors when mouse is clicked
            $("#slit-input-control").show();

            $("#pocket-input-control").hide();
            $("#hole-input-control").hide();
            $("#flap-input-control").hide();

          }else if (selectedOption === "Flap") {
            // Apply new colors when mouse is clicked
            $("#flap-input-control").show();

            $("#pocket-input-control").hide();
            $("#slit-input-control").hide();
            $("#hole-input-control").hide();
          }
        });

        //button to apply selected af to garment
        $("#applyHoleColor").click(function () {
          // if(colors.afNodes === )
          // $("#setGroupColor").click(function () {
          currentGroupColor = $("#hole-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {

            if (afNodes[nodeKey] === "#FF0000") {
              // if ((afNodes[nodeKey] === "#0022ff") && $("#hole-list-container").isEmpty()) {
              // $("#final-af-list-container").append('<div class="hole-list-item">' + 'Neck' + '</div>')
              // }
              afNodes[nodeKey] = currentGroupColor;
              holeNodes[nodeKey] = currentGroupColor;
            }

          });

          //
          //   drawSweater();
          // });

          // colors.afNodes = $("#hole-nodeColor").val();
          // holeNodes = afNodes;
          // $("#hole-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container-sock").empty();
          // colors.afNodes = "#FF0000";
          // afNodes.empty();
          drawSock();
        });
        $("#applyPocketColor").click(function () {
          currentGroupColor = $("#pocket-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            //afNodes[nodeKey] = currentGroupColor;
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              pocketNodes[nodeKey] = currentGroupColor;
            }
          });

          //$("#pocket-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container-sock").empty();

          // afNodes.empty();
          drawSock();
        });
        $("#applySlitColors").click(function () {
          currentGroupColor = $("#slit-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              slitNodes[nodeKey] = currentGroupColor;
            }
          });

          //$("#slit-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container-sock").empty();

          // afNodes.empty();
          drawSock();
        });
        $("#applyFlapColors").click(function () {
          currentGroupColor = $("#flap-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              flapNodes[nodeKey] = currentGroupColor;
            }
          });

          //$("#flap-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container-sock").empty();

          // afNodes.empty();
          drawSock();
        });
        // Initial Draw
        adjustCanvasSize();
        drawSock();

        // Mouse wheel zoom functionality
        $('#sockCanvas').on('wheel', function (e) {
          e.preventDefault();
          if (e.originalEvent.deltaY < 0) {
            scaleFactor *= 1.1;  // Zoom in
          } else {
            scaleFactor *= 0.9;  // Zoom out
          }

          // Prevent zooming too much in or out
          if (scaleFactor < 0.1) scaleFactor = 0.1;
          if (scaleFactor > 5) scaleFactor = 5;

          adjustCanvasSize();
          drawSock();
        });

        // Track mouse dragging to select nodes
        let isDragging = false;
        let lastMousePos = { x: 0, y: 0 };

        //start dragging or select a node with mouse
        $('#sockCanvas').on('mousedown', function (e) {
          // Get mouse position on canvas
          let mouseX = e.offsetX;
          let mouseY = e.offsetY;

          // Correct the position for zoom scaling
          mouseX /= scaleFactor;
          mouseY /= scaleFactor;

          // Calculate which node is under the mouse
          let col = Math.floor((mouseX - 10) / (nodeSize + gap));
          let row = Math.floor((mouseY - 10) / (nodeSize + gap));

          // Check if the click is inside the sweater area
          if (row >= 0 && row < totalHeight && col >= 0 && col < totalWidth) {
            let key = `${row}-${col}`;

            if (!e.shiftKey) {
              if (afNodes[key]) {
                delete afNodes[key];
              } else {
                afNodes[key] = currentGroupColor;
              }
            } else {
              afNodes[key] = currentGroupColor;
            }
            // let key = `${row}-${col}`;
            //
            // if (!e.shiftKey) {
            //   // Toggle the selection of the node when clicking without shift
            //   if (afNodes[key]) {
            //     delete afNodes[key];
            //   } else {
            //     afNodes[key] = true;
            //   }
            // } else {
            //   // Always select the node if shift is pressed
            //   afNodes[key] = true;
            // }
          }

          // Start the drag
          isDragging = true;
          lastMousePos = { x: e.offsetX, y: e.offsetY };

          drawSock();
        });

        // select nodes while dragging mouse
        $('#sockCanvas').on('mousemove', function (e) {
          if (isDragging) {
            // Get mouse position on garment
            let mouseX = e.offsetX;
            let mouseY = e.offsetY;

            //Correct the position for zoom scaling
            mouseX /= scaleFactor;
            mouseY /= scaleFactor;

            // Calculate which node is under the mouse
            let col = Math.floor((mouseX - 10) / (nodeSize + gap));
            let row = Math.floor((mouseY - 10) / (nodeSize + gap));

            // Check if the mouse is inside the sweater area
            if (row >= 0 && row < totalHeight && col >= 0 && col < totalWidth) {
              let key = `${row}-${col}`;
              if (!afNodes[key]) {
                afNodes[key] = currentGroupColor;
              }
              // let key = `${row}-${col}`;
              // if (!afNodes[key]) {
              //   afNodes[key] = true; // Select the node
              // }
            }

            drawSock();
          }
        });

        //end the dragging
        $('#sockCanvas').on('mouseup', function () {
          isDragging = false;
        });

      });
      $("#compile-glove-button").click(function () {
        // Collect measurements for glove garment
        var palm_circum = $("#palm-circumference-input").val();
        var palm_len = $("#palm-length-input").val();
        var wrist_circum = $("#wrist-circumference-input").val();
        var wrist_len = $("#wrist-length-input").val();
        var index_circum = $("#index-finger-circumference-input").val();
        var index_len = $("#index-finger-length-input").val();
        var middle_circum = $("#middle-finger-circumference-input").val();
        var middle_len = $("#middle-finger-length-input").val();
        var ring_circum = $("#ring-finger-circumference-input").val();
        var ring_len = $("#ring-finger-length-input").val();
        var thumb_circum = $("#thumb-circumference-input").val();
        var thumb_len = $("#thumb-length-input").val();
        var pinky_circum = $("#pinky-finger-circumference-input").val();
        var pinky_len = $("#pinky-finger-length-input").val();

        // Compact Measurements
        var glove_measurements = {
          palm_circum: palm_circum,
          palm_len: palm_len,
          wrist_circum: wrist_circum,
          wrist_len: wrist_len,
          index_circum: index_circum,
          index_len: index_len,
          middle_circum: middle_circum,
          middle_len: middle_len,
          ring_circum: ring_circum,
          ring_len: ring_len,
          thumb_circum: thumb_circum,
          thumb_len: thumb_len,
          pinky_circum: pinky_circum,
          pinky_len: pinky_len
        };



        // Send data to Python server using AJAX
        $.ajax({
          url: "http://127.0.0.1:5000/glove_inputs",  // Flask endpoint
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify(glove_measurements),
          success: function (response) {
            console.log("Response from Python:", response);
          },
          error: function (error) {
            console.error("Error:", error);
          }
        });
        //add in input box on UI for gauge and vert_gauge
        let gauge = 12;
        let vert_gauge = gauge * 1.8; //18?
        let palmWidth = Math.floor((gauge * palm_circum * 0.95));
        let palmHeightMid = Math.floor(vert_gauge * palm_len * 0.9);
        let palmHeightPink = Math.floor(palmHeightMid*0.9);
        let wristWidth = Math.floor((gauge * wrist_circum * 0.95));//160;
        let wristHeight = Math.floor(vert_gauge * wrist_len * 0.9);
        let thumbWidth = Math.floor((gauge * thumb_circum * 0.95));
        let thumbHeight = Math.floor(vert_gauge * thumb_len * 0.9);
        let indexWidth = Math.floor((gauge * index_circum * 0.95));
        let indexHeight = Math.floor((vert_gauge * index_len * 0.9));
        let middleWidth = Math.floor((gauge * middle_circum * 0.95));
        let middleHeight = Math.floor((vert_gauge * middle_len * 0.9));
        let ringWidth = Math.floor((gauge * ring_circum * 0.95));
        let ringHeight = Math.floor((vert_gauge * ring_len * 0.9));
        let pinkWidth = Math.floor((gauge * pinky_circum * 0.95));
        let pinkHeight = Math.floor((vert_gauge * pinky_len * 0.9));


        if (palmWidth % 2 !== 0){
          palmWidth -= 1;
        }
        if (wristWidth % 2 !== 0){
          wristWidth -= 1;
        }
        if (thumbWidth % 2 !== 0){
          thumbWidth -= 1;
        }if (indexWidth % 2 !== 0){
          indexWidth -= 1;
        }
        if (middleWidth % 2 !== 0){
          middleWidth -= 1;
        }
        if (ringWidth % 2 !== 0){
          ringWidth -= 1;
        }
        if (pinkWidth % 2 !== 0){
          pinkWidth -= 1;
        }

        wristWidth = Math.floor((wristWidth/2));
        thumbWidth = Math.floor((thumbWidth/2));
        indexWidth = Math.floor((indexWidth/2));
        middleWidth = Math.floor((middleWidth/2));
        ringWidth = Math.floor((ringWidth/2));
        pinkWidth = Math.floor((pinkWidth/2));
        palmWidth = Math.floor(indexWidth+middleWidth+ringWidth+pinkWidth+3);


        let thumb_start_needle = palmWidth + 1;
        let thumb_end_needle = palmWidth+thumbWidth;
        let palm_pinky_to_fingers_height = palmHeightMid-palmHeightPink;
        let pinky_start_needle = 0;
        let pinky_end_needle = pinkWidth;
        let index_start_needle = palmWidth-indexWidth;
        let middle_start_needle = index_start_needle-middleWidth-1;
        let ring_start_needle = middle_start_needle-ringWidth-1;
        //**** ADD IFS TO CHECK FOR IF MIDDLE IS NOT LONGEST FINGER ****
        let longest_finger_Height = middleHeight;

        let totalWidth = palmWidth + thumbWidth + 1;
        let totalHeight = palmHeightMid + middleHeight + wristHeight + 2;
        if ((indexHeight >= middleHeight) && (indexHeight >= thumbHeight) && (indexHeight >= ringHeight) && (indexHeight >= pinkHeight)) {
          totalHeight -= middleHeight;
          totalHeight += indexHeight;
          longest_finger_Height = indexHeight;
        }else if ((ringHeight >= middleHeight) && (ringHeight >= thumbHeight) && (ringHeight >= indexHeight) && (ringHeight >= pinkHeight)) {
          totalHeight -= middleHeight;
          totalHeight += ringHeight;
          longest_finger_Height = ringHeight;
        }else if ((pinkHeight > middleHeight) && (pinkHeight > thumbHeight) && (pinkHeight > indexHeight) && (pinkHeight > ringHeight)) {
          totalHeight -= middleHeight;
          totalHeight += pinkHeight
          longest_finger_Height = pinkHeight;
        }else if ((thumbHeight >= middleHeight) && (thumbHeight >= ringHeight) && (thumbHeight >= indexHeight) && (thumbHeight >= pinkHeight)) {
          totalHeight -= middleHeight;
          totalHeight += thumbHeight;
        }

        let palm_thumb_inc = Math.floor((totalWidth-wristWidth+1)/2);
        let palm_after_thumb_inc = Math.floor(palm_thumb_inc);

        let middle_tip_start_height = 0;
        let index_tip_start_height = 0;
        let ring_tip_start_height = 0;
        let pinky_tip_start_height = 0;
        if(longest_finger_Height !== middleHeight) {
          middle_tip_start_height = longest_finger_Height-middleHeight;
        }
        if(longest_finger_Height !== indexHeight) {
          index_tip_start_height = longest_finger_Height-indexHeight;
        }
        if(longest_finger_Height !== ringHeight) {
          ring_tip_start_height = longest_finger_Height-ringHeight;
        }
        if(longest_finger_Height !== pinkHeight) {
          pinky_tip_start_height = (longest_finger_Height+palm_pinky_to_fingers_height)-pinkHeight;
        }

        let nodeSize = 5;  // Each stitch (smaller for large grids)
        let gap = 1;       // Space between nodes

        let canvas = document.getElementById("gloveCanvas");
        let ctx = canvas.getContext("2d");

        // Canvas scale factor (used for zooming)
        let scaleFactor = 1;

        // Initial Colors for the sweater
        let colors = {
          finger: "#0022ff",
          palm: "#2d4efa",
          thumb: "#637df8",
          wristThumbInc: "#93a9f6",
          wrist: "#93a9f6",
          // torso: "#c3d7ff",
          afNodes: "#FF0000",
          holeNodes: "#ff6a00",
          pocketNodes: "#08ff00",
          flapNodes: "#000000",
          slitNodes: "#a600ff",
        };

        let afNodes = {}; // To store selected nodes
        let holeNodes = {};
        let pocketNodes = {};
        let flapNodes = {};
        let slitNodes = {};
        let currentGroupColor = "#FF0000";

        var duplicateSectionName = false;

        // Adjust canvas size dynamically
        function adjustCanvasSize() {
          canvas.width = (totalWidth * (nodeSize + gap)) * scaleFactor + 20;
          canvas.height = (totalHeight * (nodeSize + gap)) * scaleFactor + 20;
        }

        // Draw the sweater graph with the current scale
        function drawGlove() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          let middleCloseInc = 0;
          let ringCloseInc = 0;
          let indexCloseInc = 0;
          let pinkyCloseInc = 0;
          let thumbCloseInc = 0;
          let palmWristDec = 0;
          // let upperSoulderInc = 0;
          // let inc1 = 0;
          // let inc2 = 0;
          // let left_sleeve_count = 0;
          // let right_sleeve_count = 0;

          currentGroupColor = "#FF0000";
          // Adjust for zooming (scaleFactor is applied here)

          for (let row = 0; row < totalHeight; row++) {

            for (let col = 0; col < totalWidth; col++) {
              let x = (col * (nodeSize + gap) + 10) * scaleFactor;
              let y = (row * (nodeSize + gap) + 10) * scaleFactor;
              let nodeColor = "white"; // Default -> empty node

              //middle fingertip close
              if ((row >= middle_tip_start_height) && (row < middle_tip_start_height+3) && (col >= ((middle_start_needle+3)-middleCloseInc)) && (col < ((middle_start_needle+middleWidth-3)+middleCloseInc))) {
                //print(neckInc);
                nodeColor = colors.finger;
              }
              //rest of middle
              if ((row >= middle_tip_start_height+3) && (row < middle_tip_start_height+middleHeight) && (col >= (middle_start_needle)) && (col < (middle_start_needle+middleWidth))) {
                //print(neckInc);
                nodeColor = colors.finger;
              }
              //index fingertip close
              if ((row >= index_tip_start_height) && (row < index_tip_start_height+3) && (col >= ((index_start_needle+3)-indexCloseInc)) && (col < ((index_start_needle+indexWidth-3)+indexCloseInc))) {
                //print(neckInc);
                nodeColor = colors.finger;
              }
              //rest of index
              if ((row >= index_tip_start_height+3) && (row < index_tip_start_height+indexHeight) && (col >= (index_start_needle)) && (col < (index_start_needle+indexWidth))) {
                //print(neckInc);
                nodeColor = colors.finger;
              }
              //ring fingertip close
              if ((row >= ring_tip_start_height) && (row < ring_tip_start_height+3) && (col >= ((ring_start_needle+3)-ringCloseInc)) && (col < ((ring_start_needle+ringWidth-3)+ringCloseInc))) {
                //print(neckInc);
                nodeColor = colors.finger;
              }
              //rest of ring
              if ((row >= ring_tip_start_height+3) && (row < ring_tip_start_height+ringHeight) && (col >= (ring_start_needle)) && (col < (ring_start_needle+ringWidth))) {
                //print(neckInc);
                nodeColor = colors.finger;
              }
              //pinky fingertip close
              if ((row >= pinky_tip_start_height) && (row < pinky_tip_start_height+3) && (col >= ((pinky_start_needle+3)-pinkyCloseInc)) && (col < ((pinky_end_needle-3)+pinkyCloseInc))) {
                //print(neckInc);
                nodeColor = colors.finger;
              }
              //rest of pinky
              if ((row >= pinky_tip_start_height+3) && (row < pinky_tip_start_height+pinkHeight) && (col >= (pinky_start_needle)) && (col < (pinky_end_needle))) {
                //print(neckInc);
                nodeColor = colors.finger;
              }
              //upper palm for three fingers
              if ((row >= middle_tip_start_height+middleHeight) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (col >= (ring_start_needle)) && (col < (palmWidth))) {
                //print(neckInc);
                nodeColor = colors.palm;
              }
              //rest of palm to thumb start
              if ((row >= middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (col >= (pinky_start_needle)) && (col < (palmWidth))) {
                //print(neckInc);
                nodeColor = colors.palm;
              }

              //thumb tip close
              if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight) && (row < ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (col >= ((thumb_start_needle+3)-thumbCloseInc)) && (col < ((thumb_start_needle+thumbWidth-3)+thumbCloseInc))) {
                //print(neckInc);
                nodeColor = colors.thumb;
              }
              //rest of thumb
              if ((row >= ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (col >= thumb_start_needle) && (col < (thumb_start_needle+thumbWidth))) {
                //print(neckInc);
                nodeColor = colors.thumb;
              }

              //palm after inc before thumb start
              if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth))) {
                //print(neckInc);
                nodeColor = colors.wristThumbInc;
              }

              //palm inc to include thumb width from wrist
              if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc+palm_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth-palmWristDec))) {
                //print(neckInc);
                nodeColor = colors.wristThumbInc;
              }
              //wrist portion
              if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_thumb_inc+palm_after_thumb_inc)) && (row < (totalHeight)) && (col >= pinky_start_needle) && (col < (wristWidth))) {
                //print(neckInc);
                nodeColor = colors.wrist;
              }

              // if(col === 0){
              //     nodeColor = colors.testColor;
              // }

              // If the node is selected, update the color for selected AF

              if (afNodes[`${row}-${col}`]) {
                nodeColor = afNodes[`${row}-${col}`];
                var afNodeLoc = `[${row},${col}]`;
                var duplicate = false;

                $(".af-list-glove-item").each(function () {
                  if ($(this).text() === afNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                });
                if (!duplicate) {
                  $("#af-list-container-glove").append('<div class="af-list-glove-item">' + `[${row},${col}]` + '</div>')
                }
              }

              var wrist = '"Wrist"';
              var palm = '"Palm"';
              var thumb = '"Thumb"';
              var index = '"Index"'; //left sleeve
              var middle = '"Middle"'; //right sleeve
              var ring = '"Ring"';
              var pinky = '"Pinky"';

              var wristDuplicate = false;
              var palmDuplicate = false;
              var thumbDuplicate = false;
              var indexDuplicate = false;
              var middleDuplicate = false;
              var ringDuplicate = false;
              var pinkyDuplicate = false;

              // var lowerShoulderDuplicate = false;
              // var upperShoulderDuplicate = false;
              // var neckDuplicate = false;


              // ctx.fillStyle = nodeColor;
              if (holeNodes[`${row}-${col}`]) {
                // nodeColor = holeNodes[`${row}-${col}`];
                // ctx.fillStyle = nodeColor;
                ctx.fillStyle = holeNodes[`${row}-${col}`];
                var holeNodeLoc = `[${row},${col}]`;
                //var duplicate = false;

                $(".hole-list-glove-item").each(function () {
                  if (($(this).text() === holeNodeLoc)) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === wrist)) {
                    wristDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === palm)) {
                    palmDuplicate = true;
                  }
                  if (($(this).text() === thumb)) {
                    thumbDuplicate = true;
                  }
                  if (($(this).text() === index)) {
                    indexDuplicate = true;
                  }
                  if (($(this).text() === middle)) {
                    middleDuplicate = true;
                  }
                  if (($(this).text() === ring)) {
                    ringDuplicate = true;
                  }
                  if (($(this).text() === pinky)) {
                    pinkyDuplicate = true;
                  }
                });

                //add section tag to hole container
                //for wrist section
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_thumb_inc+palm_after_thumb_inc)) && (row < (totalHeight)) && (col >= pinky_start_needle) && (col < (wristWidth))) {
                  if (!wristDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === "Low_Palm") {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Wrist"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Wrist"' + '</div>');
                    }
                    relativeHeight = (totalHeight);
                  }
                }
                //for palm increase to thumb width section
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc+palm_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth-palmWristDec))) {
                  if (!palmDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === "Low_Palm") {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Low_Palm"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Low_Palm"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight);
                  }
                }
                //for palm section after increase to thumb width section but before start of thumb
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth))) {
                  if (!palmDuplicate) {
                    if (($("#hole-list-container-glove div:first").text() === thumb) || ($("#hole-list-container-glove div:first").text() === "High_Palm")){
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Low_Palm"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Low_Palm"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight);
                  }
                }
                //rest of thumb
                if ((row >= ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (col >= thumb_start_needle) && (col < (thumb_start_needle+thumbWidth))) {
                  if (!thumbDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === thumb) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Thumb"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Thumb"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc));
                  }
                }
                //thumb tip close
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight) && (row < ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (col >= ((thumb_start_needle+3)-thumbCloseInc)) && (col < ((thumb_start_needle+thumbWidth-3)+thumbCloseInc))) {
                  if (!thumbDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === thumb) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Thumb"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Thumb"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc));
                  }
                }

                //rest of palm to thumb start
                if ((row >= middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))) && (col >= (pinky_start_needle)) && (col < (palmWidth))) {
                  if (!palmDuplicate) {
                    if (($("#hole-list-container-glove div:first").text() === "Upper_Palm") || ($("#hole-list-container-glove div:first").text() === pinky)){
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    }
                    relativeHeight = relativeHeight = (totalHeight-wristHeight);
                  }
                }

                //upper palm for three fingers
                if ((row >= middle_tip_start_height+middleHeight) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (col >= (ring_start_needle)) && (col < (palmWidth))) {
                  if (!palmDuplicate) {
                    if (($("#hole-list-container-glove div:first").text() === ring) || ($("#hole-list-container-glove div:first").text() === middle) || ($("#hole-list-container-glove div:first").text() === index)){
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    }
                    relativeHeight = relativeHeight = (totalHeight-wristHeight);
                  }
                }

                //rest of pinky
                if ((row >= pinky_tip_start_height+3) && (row < pinky_tip_start_height+pinkHeight) && (col >= (pinky_start_needle)) && (col < (pinky_end_needle))) {
                  if (!pinkyDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === pinky) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Pinky"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Pinky"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)));
                  }
                }
                //pinky fingertip close
                if ((row >= pinky_tip_start_height) && (row < pinky_tip_start_height+3) && (col >= ((pinky_start_needle+3)-pinkyCloseInc)) && (col < ((pinky_end_needle-3)+pinkyCloseInc))) {
                  if (!pinkyDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === pinky) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Pinky"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Pinky"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)));
                  }
                }

                //rest of ring
                if ((row >= ring_tip_start_height+3) && (row < ring_tip_start_height+ringHeight) && (col >= (ring_start_needle)) && (col < (ring_start_needle+ringWidth))) {
                  if (!ringDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === ring) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Ring"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Ring"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //ring fingertip close
                if ((row >= ring_tip_start_height) && (row < ring_tip_start_height+3) && (col >= ((ring_start_needle+3)-ringCloseInc)) && (col < ((ring_start_needle+ringWidth-3)+ringCloseInc))) {
                  if (!ringDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === ring) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Ring"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Ring"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //rest of index
                if ((row >= index_tip_start_height+3) && (row < index_tip_start_height+indexHeight) && (col >= (index_start_needle)) && (col < (index_start_needle+indexWidth))) {
                  if (!indexDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === index) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Index"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Index"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //index fingertip close
                if ((row >= index_tip_start_height) && (row < index_tip_start_height+3) && (col >= ((index_start_needle+3)-indexCloseInc)) && (col < ((index_start_needle+indexWidth-3)+indexCloseInc))) {
                  if (!indexDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === index) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Index"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Index"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //rest of middle
                if ((row >= middle_tip_start_height+3) && (row < middle_tip_start_height+middleHeight) && (col >= (middle_start_needle)) && (col < (middle_start_needle+middleWidth))) {
                  if (!middleDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === middle) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Middle"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Middle"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //middle fingertip close
                if ((row >= middle_tip_start_height) && (row < middle_tip_start_height+3) && (col >= ((middle_start_needle+3)-middleCloseInc)) && (col < ((middle_start_needle+middleWidth-3)+middleCloseInc))) {
                  if (!middleDuplicate) {
                    if ($("#hole-list-container-glove div:first").text() === middle) {
                      // Replace the first div with the new content
                      $("#hole-list-container-glove div:first").replaceWith('<div class="hole-list-glove-item">' + '"Middle"' + '</div>');
                    } else {
                      $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + '"Middle"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //add needle locations
                if (!duplicate && (afNodes[`${row}-${col}`] === colors.holeNodes)) {
                  $("#hole-list-container-glove").append('<div class="hole-list-glove-item">' + `[${row},${col}]` + '</div>');
                }

              } else if (pocketNodes[`${row}-${col}`]) {
                ctx.fillStyle = pocketNodes[`${row}-${col}`];
                var pocketNodeLoc = `[${row},${col}]`;
                var duplicateSectionNamePocket = false;
                //var duplicate = false;

                $(".pocket-list-glove-item").each(function () {
                  if ($(this).text() === pocketNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === wrist)) {
                    wristDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === palm)) {
                    palmDuplicate = true;
                  }
                  if (($(this).text() === thumb)) {
                    thumbDuplicate = true;
                  }
                  if (($(this).text() === index)) {
                    indexDuplicate = true;
                  }
                  if (($(this).text() === middle)) {
                    middleDuplicate = true;
                  }
                  if (($(this).text() === ring)) {
                    ringDuplicate = true;
                  }
                  if (($(this).text() === pinky)) {
                    pinkyDuplicate = true;
                  }
                });

                //add section tag to pocket container
                //for wrist section
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_thumb_inc+palm_after_thumb_inc)) && (row < (totalHeight)) && (col >= pinky_start_needle) && (col < (wristWidth))) {
                  if (!wristDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === "Low_Palm") {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Wrist"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Wrist"' + '</div>');
                    }
                    relativeHeight = (totalHeight);
                  }
                }
                //for palm increase to thumb width section
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc+palm_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth-palmWristDec))) {
                  if (!palmDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === "Low_Palm") {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Low_Palm"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Low_Palm"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight);
                  }
                }
                //for palm section after increase to thumb width section but before start of thumb
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth))) {
                  if (!palmDuplicate) {
                    if (($("#pocket-list-container-glove div:first").text() === thumb) || ($("#pocket-list-container-glove div:first").text() === "High_Palm")){
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Low_Palm"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Low_Palm"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight);
                  }
                }
                //rest of thumb
                if ((row >= ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (col >= thumb_start_needle) && (col < (thumb_start_needle+thumbWidth))) {
                  if (!thumbDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === thumb) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Thumb"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Thumb"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc));
                  }
                }
                //thumb tip close
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight) && (row < ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (col >= ((thumb_start_needle+3)-thumbCloseInc)) && (col < ((thumb_start_needle+thumbWidth-3)+thumbCloseInc))) {
                  if (!thumbDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === thumb) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Thumb"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Thumb"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc));
                  }
                }

                //rest of palm to thumb start
                if ((row >= middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))) && (col >= (pinky_start_needle)) && (col < (palmWidth))) {
                  if (!palmDuplicate) {
                    if (($("#pocket-list-container-glove div:first").text() === "Upper_Palm") || ($("#pocket-list-container-glove div:first").text() === pinky)){
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    }
                    relativeHeight = relativeHeight = (totalHeight-wristHeight);
                  }
                }

                //upper palm for three fingers
                if ((row >= middle_tip_start_height+middleHeight) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (col >= (ring_start_needle)) && (col < (palmWidth))) {
                  if (!palmDuplicate) {
                    if (($("#pocket-list-container-glove div:first").text() === ring) || ($("#pocket-list-container-glove div:first").text() === middle) || ($("#pocket-list-container-glove div:first").text() === index)){
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    }
                    relativeHeight = relativeHeight = (totalHeight-wristHeight);
                  }
                }

                //rest of pinky
                if ((row >= pinky_tip_start_height+3) && (row < pinky_tip_start_height+pinkHeight) && (col >= (pinky_start_needle)) && (col < (pinky_end_needle))) {
                  if (!pinkyDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === pinky) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Pinky"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Pinky"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)));
                  }
                }
                //pinky fingertip close
                if ((row >= pinky_tip_start_height) && (row < pinky_tip_start_height+3) && (col >= ((pinky_start_needle+3)-pinkyCloseInc)) && (col < ((pinky_end_needle-3)+pinkyCloseInc))) {
                  if (!pinkyDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === pinky) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Pinky"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Pinky"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)));
                  }
                }

                //rest of ring
                if ((row >= ring_tip_start_height+3) && (row < ring_tip_start_height+ringHeight) && (col >= (ring_start_needle)) && (col < (ring_start_needle+ringWidth))) {
                  if (!ringDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === ring) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Ring"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Ring"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //ring fingertip close
                if ((row >= ring_tip_start_height) && (row < ring_tip_start_height+3) && (col >= ((ring_start_needle+3)-ringCloseInc)) && (col < ((ring_start_needle+ringWidth-3)+ringCloseInc))) {
                  if (!ringDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === ring) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Ring"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Ring"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //rest of index
                if ((row >= index_tip_start_height+3) && (row < index_tip_start_height+indexHeight) && (col >= (index_start_needle)) && (col < (index_start_needle+indexWidth))) {
                  if (!indexDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === index) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Index"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Index"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //index fingertip close
                if ((row >= index_tip_start_height) && (row < index_tip_start_height+3) && (col >= ((index_start_needle+3)-indexCloseInc)) && (col < ((index_start_needle+indexWidth-3)+indexCloseInc))) {
                  if (!indexDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === index) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Index"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Index"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //rest of middle
                if ((row >= middle_tip_start_height+3) && (row < middle_tip_start_height+middleHeight) && (col >= (middle_start_needle)) && (col < (middle_start_needle+middleWidth))) {
                  if (!middleDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === middle) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Middle"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Middle"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //middle fingertip close
                if ((row >= middle_tip_start_height) && (row < middle_tip_start_height+3) && (col >= ((middle_start_needle+3)-middleCloseInc)) && (col < ((middle_start_needle+middleWidth-3)+middleCloseInc))) {
                  if (!middleDuplicate) {
                    if ($("#pocket-list-container-glove div:first").text() === middle) {
                      // Replace the first div with the new content
                      $("#pocket-list-container-glove div:first").replaceWith('<div class="pocket-list-glove-item">' + '"Middle"' + '</div>');
                    } else {
                      $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + '"Middle"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                if (!duplicate) {
                  $("#pocket-list-container-glove").append('<div class="pocket-list-glove-item">' + `[${row},${col}]` + '</div>')
                }
                //sort by row position
                // var pocket_items = $(".pocket-list-item").get();
                // pocket_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                //$("#pocket-list-container").empty().append(pocket_items);
              } else if (slitNodes[`${row}-${col}`]) {
                nodeColor = slitNodes[`${row}-${col}`];
                ctx.fillStyle = nodeColor;
                var slitNodeLoc = `[${row},${col}]`;
                var duplicateSectionNameSlit = false;
                //var duplicate = false;

                $(".slit-list-glove-item").each(function () {
                  if ($(this).text() === slitNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === wrist)) {
                    wristDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === palm)) {
                    palmDuplicate = true;
                  }
                  if (($(this).text() === thumb)) {
                    thumbDuplicate = true;
                  }
                  if (($(this).text() === index)) {
                    indexDuplicate = true;
                  }
                  if (($(this).text() === middle)) {
                    middleDuplicate = true;
                  }
                  if (($(this).text() === ring)) {
                    ringDuplicate = true;
                  }
                  if (($(this).text() === pinky)) {
                    pinkyDuplicate = true;
                  }
                });

                //add section tag to slit container
                //for wrist section
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_thumb_inc+palm_after_thumb_inc)) && (row < (totalHeight)) && (col >= pinky_start_needle) && (col < (wristWidth))) {
                  if (!wristDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === "Low_Palm") {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Wrist"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Wrist"' + '</div>');
                    }
                    relativeHeight = (totalHeight);
                  }
                }
                //for palm increase to thumb width section
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc+palm_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth-palmWristDec))) {
                  if (!palmDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === "Low_Palm") {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Low_Palm"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Low_Palm"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight);
                  }
                }
                //for palm section after increase to thumb width section but before start of thumb
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth))) {
                  if (!palmDuplicate) {
                    if (($("#slit-list-container-glove div:first").text() === thumb) || ($("#slit-list-container-glove div:first").text() === "High_Palm")){
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Low_Palm"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Low_Palm"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight);
                  }
                }
                //rest of thumb
                if ((row >= ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (col >= thumb_start_needle) && (col < (thumb_start_needle+thumbWidth))) {
                  if (!thumbDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === thumb) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Thumb"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Thumb"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc));
                  }
                }
                //thumb tip close
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight) && (row < ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (col >= ((thumb_start_needle+3)-thumbCloseInc)) && (col < ((thumb_start_needle+thumbWidth-3)+thumbCloseInc))) {
                  if (!thumbDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === thumb) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Thumb"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Thumb"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc));
                  }
                }

                //rest of palm to thumb start
                if ((row >= middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))) && (col >= (pinky_start_needle)) && (col < (palmWidth))) {
                  if (!palmDuplicate) {
                    if (($("#slit-list-container-glove div:first").text() === "Upper_Palm") || ($("#slit-list-container-glove div:first").text() === pinky)){
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    }
                    relativeHeight = relativeHeight = (totalHeight-wristHeight);
                  }
                }

                //upper palm for three fingers
                if ((row >= middle_tip_start_height+middleHeight) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (col >= (ring_start_needle)) && (col < (palmWidth))) {
                  if (!palmDuplicate) {
                    if (($("#slit-list-container-glove div:first").text() === ring) || ($("#slit-list-container-glove div:first").text() === middle) || ($("#slit-list-container-glove div:first").text() === index)){
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    }
                    relativeHeight = relativeHeight = (totalHeight-wristHeight);
                  }
                }

                //rest of pinky
                if ((row >= pinky_tip_start_height+3) && (row < pinky_tip_start_height+pinkHeight) && (col >= (pinky_start_needle)) && (col < (pinky_end_needle))) {
                  if (!pinkyDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === pinky) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Pinky"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Pinky"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)));
                  }
                }
                //pinky fingertip close
                if ((row >= pinky_tip_start_height) && (row < pinky_tip_start_height+3) && (col >= ((pinky_start_needle+3)-pinkyCloseInc)) && (col < ((pinky_end_needle-3)+pinkyCloseInc))) {
                  if (!pinkyDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === pinky) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Pinky"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Pinky"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)));
                  }
                }

                //rest of ring
                if ((row >= ring_tip_start_height+3) && (row < ring_tip_start_height+ringHeight) && (col >= (ring_start_needle)) && (col < (ring_start_needle+ringWidth))) {
                  if (!ringDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === ring) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Ring"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Ring"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //ring fingertip close
                if ((row >= ring_tip_start_height) && (row < ring_tip_start_height+3) && (col >= ((ring_start_needle+3)-ringCloseInc)) && (col < ((ring_start_needle+ringWidth-3)+ringCloseInc))) {
                  if (!ringDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === ring) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Ring"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Ring"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //rest of index
                if ((row >= index_tip_start_height+3) && (row < index_tip_start_height+indexHeight) && (col >= (index_start_needle)) && (col < (index_start_needle+indexWidth))) {
                  if (!indexDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === index) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Index"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Index"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //index fingertip close
                if ((row >= index_tip_start_height) && (row < index_tip_start_height+3) && (col >= ((index_start_needle+3)-indexCloseInc)) && (col < ((index_start_needle+indexWidth-3)+indexCloseInc))) {
                  if (!indexDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === index) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Index"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Index"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //rest of middle
                if ((row >= middle_tip_start_height+3) && (row < middle_tip_start_height+middleHeight) && (col >= (middle_start_needle)) && (col < (middle_start_needle+middleWidth))) {
                  if (!middleDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === middle) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Middle"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Middle"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //middle fingertip close
                if ((row >= middle_tip_start_height) && (row < middle_tip_start_height+3) && (col >= ((middle_start_needle+3)-middleCloseInc)) && (col < ((middle_start_needle+middleWidth-3)+middleCloseInc))) {
                  if (!middleDuplicate) {
                    if ($("#slit-list-container-glove div:first").text() === middle) {
                      // Replace the first div with the new content
                      $("#slit-list-container-glove div:first").replaceWith('<div class="slit-list-glove-item">' + '"Middle"' + '</div>');
                    } else {
                      $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + '"Middle"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                if (!duplicate) {
                  $("#slit-list-container-glove").append('<div class="slit-list-glove-item">' + `[${row},${col}]` + '</div>')
                }

                //sort by row position
                // var slit_items = $(".slit-list-item").get();
                // slit_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                // $("#slit-list-container").empty().append(slit_items);
              } else if (flapNodes[`${row}-${col}`]) {
                nodeColor = flapNodes[`${row}-${col}`];
                ctx.fillStyle = nodeColor;
                var flapNodeLoc = `[${row},${col}]`;
                var duplicateSectionNameFlap = false;
                //var duplicate = false;

                $(".flap-list-glove-item").each(function () {
                  if ($(this).text() === flapNodeLoc) {
                    duplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === wrist)) {
                    wristDuplicate = true;
                    // return false; // Break loop
                  }
                  if (($(this).text() === palm)) {
                    palmDuplicate = true;
                  }
                  if (($(this).text() === thumb)) {
                    thumbDuplicate = true;
                  }
                  if (($(this).text() === index)) {
                    indexDuplicate = true;
                  }
                  if (($(this).text() === middle)) {
                    middleDuplicate = true;
                  }
                  if (($(this).text() === ring)) {
                    ringDuplicate = true;
                  }
                  if (($(this).text() === pinky)) {
                    pinkyDuplicate = true;
                  }
                });

                //add section tag to pocket container
                //for wrist section
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_thumb_inc+palm_after_thumb_inc)) && (row < (totalHeight)) && (col >= pinky_start_needle) && (col < (wristWidth))) {
                  if (!wristDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === "Low_Palm") {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Wrist"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Wrist"' + '</div>');
                    }
                    relativeHeight = (totalHeight);
                  }
                }
                //for palm increase to thumb width section
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc+palm_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth-palmWristDec))) {
                  if (!palmDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === "Low_Palm") {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Low_Palm"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Low_Palm"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight);
                  }
                }
                //for palm section after increase to thumb width section but before start of thumb
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc)) && (col >= pinky_start_needle) && (col < (totalWidth))) {
                  if (!palmDuplicate) {
                    if (($("#flap-list-container-glove div:first").text() === thumb) || ($("#flap-list-container-glove div:first").text() === "High_Palm")){
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Low_Palm"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Low_Palm"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight);
                  }
                }
                //rest of thumb
                if ((row >= ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (row < (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))) && (col >= thumb_start_needle) && (col < (thumb_start_needle+thumbWidth))) {
                  if (!thumbDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === thumb) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Thumb"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Thumb"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc));
                  }
                }
                //thumb tip close
                if ((row >= (middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight) && (row < ((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight)+3) && (col >= ((thumb_start_needle+3)-thumbCloseInc)) && (col < ((thumb_start_needle+thumbWidth-3)+thumbCloseInc))) {
                  if (!thumbDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === thumb) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Thumb"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Thumb"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc));
                  }
                }

                //rest of palm to thumb start
                if ((row >= middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))) && (col >= (pinky_start_needle)) && (col < (palmWidth))) {
                  if (!palmDuplicate) {
                    if (($("#flap-list-container-glove div:first").text() === "Upper_Palm") || ($("#flap-list-container-glove div:first").text() === pinky)){
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    }
                    relativeHeight = relativeHeight = (totalHeight-wristHeight);
                  }
                }

                //upper palm for three fingers
                if ((row >= middle_tip_start_height+middleHeight) && (row < middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height) && (col >= (ring_start_needle)) && (col < (palmWidth))) {
                  if (!palmDuplicate) {
                    if (($("#flap-list-container-glove div:first").text() === ring) || ($("#flap-list-container-glove div:first").text() === middle) || ($("#flap-list-container-glove div:first").text() === index)){
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Upper_Palm"' + '</div>');
                    }
                    relativeHeight = relativeHeight = (totalHeight-wristHeight);
                  }
                }

                //rest of pinky
                if ((row >= pinky_tip_start_height+3) && (row < pinky_tip_start_height+pinkHeight) && (col >= (pinky_start_needle)) && (col < (pinky_end_needle))) {
                  if (!pinkyDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === pinky) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Pinky"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Pinky"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)));
                  }
                }
                //pinky fingertip close
                if ((row >= pinky_tip_start_height) && (row < pinky_tip_start_height+3) && (col >= ((pinky_start_needle+3)-pinkyCloseInc)) && (col < ((pinky_end_needle-3)+pinkyCloseInc))) {
                  if (!pinkyDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === pinky) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Pinky"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Pinky"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)));
                  }
                }

                //rest of ring
                if ((row >= ring_tip_start_height+3) && (row < ring_tip_start_height+ringHeight) && (col >= (ring_start_needle)) && (col < (ring_start_needle+ringWidth))) {
                  if (!ringDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === ring) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Ring"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Ring"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //ring fingertip close
                if ((row >= ring_tip_start_height) && (row < ring_tip_start_height+3) && (col >= ((ring_start_needle+3)-ringCloseInc)) && (col < ((ring_start_needle+ringWidth-3)+ringCloseInc))) {
                  if (!ringDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === ring) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Ring"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Ring"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //rest of index
                if ((row >= index_tip_start_height+3) && (row < index_tip_start_height+indexHeight) && (col >= (index_start_needle)) && (col < (index_start_needle+indexWidth))) {
                  if (!indexDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === index) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Index"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Index"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //index fingertip close
                if ((row >= index_tip_start_height) && (row < index_tip_start_height+3) && (col >= ((index_start_needle+3)-indexCloseInc)) && (col < ((index_start_needle+indexWidth-3)+indexCloseInc))) {
                  if (!indexDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === index) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Index"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Index"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //rest of middle
                if ((row >= middle_tip_start_height+3) && (row < middle_tip_start_height+middleHeight) && (col >= (middle_start_needle)) && (col < (middle_start_needle+middleWidth))) {
                  if (!middleDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === middle) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Middle"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Middle"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                //middle fingertip close
                if ((row >= middle_tip_start_height) && (row < middle_tip_start_height+3) && (col >= ((middle_start_needle+3)-middleCloseInc)) && (col < ((middle_start_needle+middleWidth-3)+middleCloseInc))) {
                  if (!middleDuplicate) {
                    if ($("#flap-list-container-glove div:first").text() === middle) {
                      // Replace the first div with the new content
                      $("#flap-list-container-glove div:first").replaceWith('<div class="flap-list-glove-item">' + '"Middle"' + '</div>');
                    } else {
                      $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + '"Middle"' + '</div>');
                    }
                    relativeHeight = (totalHeight-wristHeight-(palm_thumb_inc+palm_after_thumb_inc)-(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))-palm_pinky_to_fingers_height);
                  }
                }

                if (!duplicate) {
                  $("#flap-list-container-glove").append('<div class="flap-list-glove-item">' + `[${row},${col}]` + '</div>')

                  if ($("#Flap-orientation-select").val() === "Side") {
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Side"' + '</div>');
                    if ($("#Flap-side-select").val() === "Right") {
                      $("#flap-list-container").append('<div class="flap-list-item">' + '"Right"' + '</div>');
                    }else if ($("#Flap-side-select").val() === "Left"){
                      $("#flap-list-container").append('<div class="flap-list-item">' + '"Left"' + '</div>');
                    }else if ($("#Flap-side-select").val() === "Both"){
                      $("#flap-list-container").append('<div class="flap-list-item">' + '"Both"' + '</div>');
                    }
                  }else if ($("#Flap-orientation-select").val() === "Horizontal"){
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Horizontal"' + '</div>');
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"None"' + '</div>');
                  }



                  if ($("#Flap-bed-select").val() === "Front") {
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Front"' + '</div>');
                  }else if ($("#Flap-bed-select").val() === "Back"){
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Back"' + '</div>');
                  }else if ($("#Flap-bed-select").val() === "Front-Back"){
                    $("#flap-list-container").append('<div class="flap-list-item">' + '"Front_Back"' + '</div>');
                  }

                  var flap_len = $("#flap-length-input").val();
                  $("#flap-list-container").append('<div class="flap-list-item">' + flap_len + '</div>');
                }

                //sort by row position
                // var flap_items = $(".flap-list-item").get();
                // flap_items.sort(function(a, b) {
                //   return $(a).text().localeCompare($(b).text());
                // });
                // $("#flap-list-container").empty().append(flap_items);
              } else {
                ctx.fillStyle = nodeColor;
              }

              // holeNodes = $("#hole-list-container");
              // if (holeNodes[`${row}-${col}`]) {
              //   let holeNodeColor = colors.holeNodes;
              //   ctx.fillStyle = holeNodeColor;
              // }else{
              //   ctx.fillStyle = nodeColor;
              // }
              // Draw circle (stitch)

              ctx.beginPath();
              ctx.arc(x, y, (nodeSize / 2) * scaleFactor, 0, Math.PI * 2);
              ctx.fill();
              ctx.strokeStyle = "black";
              ctx.lineWidth = 0.3 * scaleFactor;
              ctx.stroke();

            }
            //slope change for fingers box
            if (middle_tip_start_height <= row) {
              middleCloseInc += 1;
            }
            if (index_tip_start_height <= row) {
              indexCloseInc += 1;
            }
            if (ring_tip_start_height <= row) {
              ringCloseInc += 1;
            }
            if (pinky_tip_start_height <= row) {
              pinkyCloseInc += 1;
            }
            if (((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc)))-thumbHeight) <= row) {
              thumbCloseInc += 1;
            }
            if (((middle_tip_start_height+middleHeight+palm_pinky_to_fingers_height+(palmHeightPink-(palm_thumb_inc+palm_after_thumb_inc))+palm_after_thumb_inc)) <= row) {
              palmWristDec += 2;
            }
          }
        }
        //buttons for printing af dims
        $("#print-all-afs-glove").click(function() {
          //var holes = $(".hole-list-item").get();
          //.append($("#source").clone());
          //copy af conatiners over to full af list for garment
          var palm_circum = $("#palm-circumference-input").val();
          var palm_len = $("#palm-length-input").val();
          var wrist_circum = $("#wrist-circumference-input").val();
          var wrist_len = $("#wrist-length-input").val();
          var index_circum = $("#index-finger-circumference-input").val();
          var index_len = $("#index-finger-length-input").val();
          var middle_circum = $("#middle-finger-circumference-input").val();
          var middle_len = $("#middle-finger-length-input").val();
          var ring_circum = $("#ring-finger-circumference-input").val();
          var ring_len = $("#ring-finger-length-input").val();
          var thumb_circum = $("#thumb-circumference-input").val();
          var thumb_len = $("#thumb-length-input").val();
          var pinky_circum = $("#pinky-finger-circumference-input").val();
          var pinky_len = $("#pinky-finger-length-input").val();

          // Compact Measurements
          var glove_measurements = {
            palm_circum: palm_circum,
            palm_len: palm_len,
            wrist_circum: wrist_circum,
            wrist_len: wrist_len,
            index_circum: index_circum,
            index_len: index_len,
            middle_circum: middle_circum,
            middle_len: middle_len,
            ring_circum: ring_circum,
            ring_len: ring_len,
            thumb_circum: thumb_circum,
            thumb_len: thumb_len,
            pinky_circum: pinky_circum,
            pinky_len: pinky_len
          };

          if (holeNodes) {
            $("#final-af-list-container-glove").append('<div class="final-af-list-glove-item">' + `[${$("#hole-list-container-glove").clone()}]` + '</div>');
          }
          if (pocketNodes) {
            $("#final-af-list-container-glove").append('<div class="final-af-list-glove-item">' + `[${$("#pocket-list-container-glove").clone()}]` + '</div>');
          }
          if (slitNodes) {
            $("#final-af-list-container-glove").append('<div class="final-af-list-glove-item">' + `[${$("#slit-list-container-glove").clone()}]` + '</div>');
          }
          if (flapNodes) {
            $("#final-af-list-container-glove").append('<div class="final-af-list-glove-item">' + `[${$("#flap-list-container-glove").clone()}]` + '</div>');
          }
          var holes = [];
          var pockets = [];
          var slits = [];
          var flaps = [];
          var temp;
          $(".final-af-list-glove-item").each(function() {
            $(".hole-list-glove-item").each(function() {
              holes.push($(this).text());
            });
            $(".pocket-list-glove-item").each(function() {
              pockets.push($(this).text());
            });
            $(".slit-list-glove-item").each(function() {
              slits.push($(this).text());
            });
            $(".flap-list-glove-item").each(function() {
              flaps.push($(this).text());
            });
          });

          let af_type = [];
          let af_tag = "none";
          if(holes.length > 0){
            af_type = holes;
            af_tag = '"Hole"';
          }else if(pockets.length > 0){
            af_type = pockets;
            af_tag = '"Pocket"';
          }else if(flaps.length > 0){
            af_type = flaps;
            af_tag = '"Flap"';
          }else if(slits.length > 0){
            af_type = slits;
            af_tag = '"Slit"';
          }

          for (let num = 1; num < af_type.length; num++) {
            let node = af_type[num];
            // Parse the stringified node into an array
            let nodeArray = JSON.parse(node);
            // Modify the first element of the array based on relativeHeight
            nodeArray[0] = relativeHeight - nodeArray[0];
            // Convert the array back into a string and update the holes array
            af_type[num] = JSON.stringify(nodeArray);
          }
          //sort the holes array (excluding the first string element)
          let uniqueAF = [];
          af_type.slice(1).forEach(item => {
            if (!uniqueAF.includes(item)) {
              uniqueAF.push(item);
            }
          });

// Sort the holes array in ascending order by the first element, and then by the second element
          let sortedAF = uniqueAF.sort((a, b) => {
            // Parse each element back into an array for sorting
            let arrA = JSON.parse(a);
            let arrB = JSON.parse(b);
            // First compare by the first element
            if (arrA[0] !== arrB[0]) {
              return arrA[0] - arrB[0];  // Ascending order for the first element
            }
            // If the first elements are equal, compare by the second element
            return arrA[1] - arrB[1];  // Ascending order for the second element
          });

// Reinsert the first string element at the beginning of the sorted array

// Reinsert the first string element at the beginning of the sorted array
          sortedAF.unshift(af_tag);
          sortedAF.unshift(af_type[0]);
          sortedAF.pop();
          full_af_list_glove.push('[' + sortedAF + ']');
          //console.log(full_af_list);
          //   return $(a).text().localeCompare($(b).text());
          // })
          //sort by row position

          // holes.sort((a, b) => {
          //   // Parse each element back into an array for sorting
          //   let arrA = JSON.parse(a);
          //   let arrB = JSON.parse(b);
          //   if (Array.isArray(arrA) && Array.isArray(arrB)) {
          //     return arrA[0] - arrB[0];
          //   }
          //   return 0;
          //   // Compare the first element of each array for ascending order
          //   //return arrA[0] - arrB[0];
          // });
          // for (let num = 1; num < holes.length; num++) {
          //   let node = holes[num];
          //   let nodePos = node.split('[', ",", ']');
          //   nodePos[0] = relativeHeight;//- parseInt(nodePos[0]));
          //   holes[num] = nodePos.join('[', ",", ']');
          // }
          $("#output-afs-loc-glove").text('[' + full_af_list_glove + '] '); //+ "[" + pockets.join(", ") + "]");
          $("#hole-list-container-glove").empty();
          holeNodes = {};
          $("#pocket-list-container-glove").empty();
          pocketNodes = {};
          $("#slit-list-container-glove").empty();
          slitNodes = {};
          $("#flap-list-container-glove").empty();
          flapNodes = {};
          //Send data to Python server using AJAX
          var garment_and_af_measurements = {
            garment_data: glove_measurements,
            af_data: full_af_list_glove,
            garment_type: "Glove",
          };

          $.ajax({
            url: "http://127.0.0.1:5000/af_inputs",  // Flask endpoint
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify(garment_and_af_measurements),
            success: function (response) {
              console.log("Response from Python:", response);
            },
            error: function (error) {
              console.error("Error:", error);
            }
          });
        });
        $("#print-hole-value-glove").click(function() {
          var items = [];
          $(".hole-list-glove-item").each(function() {
            items.push($(this).text());
          });
          $("#output-hole-loc-glove").text("List Items: " + items.join(", "));
        });
        $("#print-pocket-value-glove").click(function() {
          var items = [];
          $(".pocket-list-glove-item").each(function() {
            items.push($(this).text());
          });
          $("#output-pocket-loc-glove").text("List Items: " + items.join(", "));
        });
        $("#print-slit-value-glove").click(function() {
          var items = [];
          $(".slit-list-glove-item").each(function() {
            items.push($(this).text());
          });
          $("#output-slit-loc-glove").text("List Items: " + items.join(", "));
        });
        $("#print-flap-value-glove").click(function() {
          var items = [];
          $(".flap-list-glove-item").each(function() {
            items.push($(this).text());
          });
          $("#output-slit-loc-glove").text("List Items: " + items.join(", "));
        });

        // $("#print-value").click(function() {
        //   // var lastInput = afNodes;
        //   $("#output-af-loc").text("AF Node Values: " + holeNodes);
        // });

        $("#AF-select").selectmenu();

        // For selecting which AF to add
        $("#AF-select").on("selectmenuchange", function () {
          var selectedOption = $(this).val();

          // Show or hide elements based on the selected option
          if (selectedOption === "Hole") {
            $("#hole-input-control").show();

            $("#pocket-input-control").hide();
            $("#slit-input-control").hide();
            $("#flap-input-control").hide();

          }else if (selectedOption === "Pocket") {
            // Apply new colors when mouse is clicked
            $("#pocket-input-control").show();

            $("#hole-input-control").hide();
            $("#slit-input-control").hide();
            $("#flap-input-control").hide();
          }else if (selectedOption === "Slit") {
            // Apply new colors when mouse is clicked
            $("#slit-input-control").show();

            $("#pocket-input-control").hide();
            $("#hole-input-control").hide();
            $("#flap-input-control").hide();

          }else if (selectedOption === "Flap") {
            // Apply new colors when mouse is clicked
            $("#flap-input-control").show();

            $("#pocket-input-control").hide();
            $("#slit-input-control").hide();
            $("#hole-input-control").hide();
          }
        });

        //button to apply selected af to garment
        $("#applyHoleColor").click(function () {
          // if(colors.afNodes === )
          // $("#setGroupColor").click(function () {
          currentGroupColor = $("#hole-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {

            if (afNodes[nodeKey] === "#FF0000") {
              // if ((afNodes[nodeKey] === "#0022ff") && $("#hole-list-container").isEmpty()) {
              // $("#final-af-list-container").append('<div class="hole-list-item">' + 'Neck' + '</div>')
              // }
              afNodes[nodeKey] = currentGroupColor;
              holeNodes[nodeKey] = currentGroupColor;
            }

          });

          //
          //   drawSweater();
          // });

          // colors.afNodes = $("#hole-nodeColor").val();
          // holeNodes = afNodes;
          // $("#hole-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container-glove").empty();
          // colors.afNodes = "#FF0000";
          // afNodes.empty();
          drawGlove();
        });
        $("#applyPocketColor").click(function () {
          currentGroupColor = $("#pocket-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            //afNodes[nodeKey] = currentGroupColor;
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              pocketNodes[nodeKey] = currentGroupColor;
            }
          });

          //$("#pocket-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container-glove").empty();

          // afNodes.empty();
          drawGlove();
        });
        $("#applySlitColors").click(function () {
          currentGroupColor = $("#slit-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              slitNodes[nodeKey] = currentGroupColor;
            }
          });

          //$("#slit-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container-glove").empty();

          // afNodes.empty();
          drawGlove();
        });
        $("#applyFlapColors").click(function () {
          currentGroupColor = $("#flap-nodeColor").val();
          //
          Object.keys(afNodes).forEach(nodeKey => {
            if (afNodes[nodeKey] === "#FF0000") {
              afNodes[nodeKey] = currentGroupColor;
              flapNodes[nodeKey] = currentGroupColor;
            }
          });

          //$("#flap-list-container").append('<div class="list-item">' +  [$("#af-list-container")]+ '</div>')
          $("#af-list-container-glove").empty();

          // afNodes.empty();
          drawGlove();
        });
        // Initial Draw
        adjustCanvasSize();
        drawGlove();

        // Mouse wheel zoom functionality
        $('#gloveCanvas').on('wheel', function (e) {
          e.preventDefault();
          if (e.originalEvent.deltaY < 0) {
            scaleFactor *= 1.1;  // Zoom in
          } else {
            scaleFactor *= 0.9;  // Zoom out
          }

          // Prevent zooming too much in or out
          if (scaleFactor < 0.1) scaleFactor = 0.1;
          if (scaleFactor > 5) scaleFactor = 5;

          adjustCanvasSize();
          drawGlove();
        });

        // Track mouse dragging to select nodes
        let isDragging = false;
        let lastMousePos = { x: 0, y: 0 };

        //start dragging or select a node with mouse
        $('#gloveCanvas').on('mousedown', function (e) {
          // Get mouse position on canvas
          let mouseX = e.offsetX;
          let mouseY = e.offsetY;

          // Correct the position for zoom scaling
          mouseX /= scaleFactor;
          mouseY /= scaleFactor;

          // Calculate which node is under the mouse
          let col = Math.floor((mouseX - 10) / (nodeSize + gap));
          let row = Math.floor((mouseY - 10) / (nodeSize + gap));

          // Check if the click is inside the sweater area
          if (row >= 0 && row < totalHeight && col >= 0 && col < totalWidth) {
            let key = `${row}-${col}`;

            if (!e.shiftKey) {
              if (afNodes[key]) {
                delete afNodes[key];
              } else {
                afNodes[key] = currentGroupColor;
              }
            } else {
              afNodes[key] = currentGroupColor;
            }
            // let key = `${row}-${col}`;
            //
            // if (!e.shiftKey) {
            //   // Toggle the selection of the node when clicking without shift
            //   if (afNodes[key]) {
            //     delete afNodes[key];
            //   } else {
            //     afNodes[key] = true;
            //   }
            // } else {
            //   // Always select the node if shift is pressed
            //   afNodes[key] = true;
            // }
          }

          // Start the drag
          isDragging = true;
          lastMousePos = { x: e.offsetX, y: e.offsetY };

          drawGlove();
        });

        // select nodes while dragging mouse
        $('#gloveCanvas').on('mousemove', function (e) {
          if (isDragging) {
            // Get mouse position on garment
            let mouseX = e.offsetX;
            let mouseY = e.offsetY;

            //Correct the position for zoom scaling
            mouseX /= scaleFactor;
            mouseY /= scaleFactor;

            // Calculate which node is under the mouse
            let col = Math.floor((mouseX - 10) / (nodeSize + gap));
            let row = Math.floor((mouseY - 10) / (nodeSize + gap));

            // Check if the mouse is inside the sweater area
            if (row >= 0 && row < totalHeight && col >= 0 && col < totalWidth) {
              let key = `${row}-${col}`;
              if (!afNodes[key]) {
                afNodes[key] = currentGroupColor;
              }
              // let key = `${row}-${col}`;
              // if (!afNodes[key]) {
              //   afNodes[key] = true; // Select the node
              // }
            }

            drawGlove();
          }
        });

        //end the dragging
        $('#gloveCanvas').on('mouseup', function () {
          isDragging = false;
        });

      });


    });


  </script>

</div>

<!--KNIT SKELETONS UI SYSTEM-->
<div class="split right">
<div id="editor">
  <div class="files">
    <div class="button load-action" id="load_action">
      Load
      <div class="load-menu">
        <a class="file" id="load">from file</a>
        <select class="button" id="use"><option value="">from server</option></select>
      </div>
    </div>
    <a class="button" id="save">Save</a>
    <a class="button" id="output_save">DAT</a>
    <a class="button" id="refresh" class="reload" title="Refresh data"></a>
    <input type="file" id="file" accept=".skel">
  </div>
  <div id="nodes">

  </div>
  <!--
  -->
  <div id="sidebar" class="sidebar">
    <div class="tab" data-panel="skeleton-editor">Skeleton</div>
    <div class="tab" data-panel="pattern-editor">Patterns</div>
    <div class="tab" data-panel="custom-editor">Custom Nodes</div>
    <div class="tab" data-panel="history-editor">History</div>
  </div>
</div>

<div id="output" class="layout">
  <!-- Toolbar -->
  <div id="toolbar" class="toolbar">
    <select id="output_type" tabindex="1">
<!--      <option value="layout">Layout</option>-->
      <option value="mesh">Mesh</option>
<!--      <option value="dat">DAT</option>-->
    </select>
    <i class="separator"></i>
    <select id="sideMode" class="for-layout for-mesh" tabindex="2">
      <option value="front-back">Front + Back</option>
      <option value="back-front">Back + Front</option>
      <option value="front">Front Only</option>
      <option value="back">Back Only</option>
    </select>
    <span class="for-layout front-back shape">
          <input type="checkbox" tabindex="3" data-text="Compact Time" id="compact">
          <select id="edit_mode" tabindex="4" onchange="this.parentNode.classList.remove('shape', 'pattern'); this.parentNode.classList.add(this.value); return false">
            <option value="shape">Shape</option>
            <option value="pattern">Pattern</option>
          </select>
          <input type="radio" tabindex="5" name="action" id="shape-select" title="Select nodes and interfaces" checked>
<!--          <span class="for-shape">-->
<!--            <span class="group" data-legend="Sizing">-->
<!--              <input type="radio" tabindex="4" name="action" id="shape-length"  title="Set length">-->
<!--              <input type="radio" tabindex="4" name="action" id="shape-width"   title="Set constant width">-->
<!--              <input type="radio" name="action" id="shape-width2"  title="Set interpolated widths (top or bottom)">-->
<!--              <input type="radio" name="action" id="shape-width3"  title="Set middle interpolated width">-->
<!--            </span>-->
<!--            <span class="group" data-legend="Layout">-->
<!--              <input type="radio" name="action" id="shape-layout-auto"   title="Automatic layout">-->
<!--              <input type="radio" name="action" id="shape-layout-manual" title="Manual layout">-->
<!--              <input type="radio" name="action" id="shape-align-left"    title="Left alignment">-->
<!--              <input type="radio" name="action" id="shape-align-center"  title="Center/uniform alignment">-->
<!--              <input type="radio" name="action" id="shape-align-right"   title="Right alignment">-->
<!--            </span>-->
<!--            <span class="group" data-legend="Seams">-->
<!--              <input type="radio" name="action" id="shape-seam-center" title="Set the shape seams to centered">-->
<!--              <input type="radio" name="action" id="shape-seam-sides"  title="Set the shape seams to the sides">-->
<!--              <input type="radio" name="action" id="shape-draw-seams"  title="Draw the shape seams manually" style="display: none">-->
<!--            </span>-->
<!--          </span>-->
          <span class="for-pattern">
            <input type="radio" tabindex="6" name="action" id="draw-pattern" title="Draw patterns">
            <span class="group" data-legend="Tools / Instructions" id="pattern-instr">
              <span class="instr top">
                <label for="instr-active">Knit</label>
                <input type="radio" name="instr-active" id="instr-active" checked>
              </span>
              <div class="bottom">
                <hr data-text="Tools">
                <span class="instr" title="Displace pattern">
                  <label for="instr-move">Move</label>
                  <input type="radio" name="instr" id="instr-move">
                </span>
                <span class="instr" title="Stretch pattern region">
                  <label for="instr-resize">Stretch</label>
                  <input type="radio" name="instr" id="instr-resize">
                </span>
                <span class="instr" title="Remove pattern locally">
                  <label for="instr-0">Clear</label>
                  <input type="radio" name="instr" id="instr-0">
                </span>
                <hr data-text="Basic">
                <span class="instr active" title="Knit stitch">
                  <label for="instr-1">Knit</label>
                  <input type="radio" tabindex="5" name="instr" id="instr-1" checked>
                </span>
                <span class="instr" title="Reversed stitch">
                  <label for="instr-2">Purl</label>
                  <input type="radio" name="instr" id="instr-2">
                </span>
                <span class="instr" title="Tuck (stacks loop)">
                  <label for="instr-3">Tuck</label>
                  <input type="radio" name="instr" id="instr-3">
                </span>
                <span class="instr" title="Miss (float, no knit/tuck)">
                  <label for="instr-4">Miss</label>
                  <input type="radio" name="instr" id="instr-4">
                </span>
                <hr data-text="Moves">
                <span class="instr" title="Move to the right by one">
                  <label for="instr-5">Front Right</label>
                  <input type="radio" name="instr" id="instr-5"  data-text="1">
                </span>
                <!--
                <span class="instr">
                  <label for="instr-6">Front</label>
                  <input type="radio" name="instr" id="instr-6"  data-text="2">
                </span> -->
<!--                <span class="instr" title="Move to the left by one">-->
<!--                  <label for="instr-7">Front Left</label>-->
<!--                  <input type="radio" name="instr" id="instr-7"  data-text="1">-->
<!--                </span>-->
                <!--
                <span class="instr">
                  <label for="instr-8">Miss</label>
                  <input type="radio" name="instr" id="instr-8"  data-text="2">
                </span> -->
<!--                <span class="instr" title="Reverse stitch, then move to the right by one">-->
<!--                  <label for="instr-9">Back Right</label>-->
<!--                  <input type="radio" name="instr" id="instr-9"  data-text="1">-->
<!--                </span>-->
                <!--
                <span class="instr">
                  <label for="instr-6">Miss</label>
                  <input type="radio" name="instr" id="instr-10" data-text="2">
                </span> -->
<!--                <span class="instr" title="Reverse stitch, then move to the left by one">-->
<!--                  <label for="instr-11">Back Left</label>-->
<!--                  <input type="radio" name="instr" id="instr-11" data-text="1">-->
<!--                </span>-->
<!--                &lt;!&ndash; <input type="radio" name="instr" id="instr-12" data-text="2"> &ndash;&gt;-->
<!--                <span class="instr" title="Reorder stitch stack (with moves)">-->
<!--                  <label for="instr-17">Stack</label>-->
<!--                  <input type="radio" name="instr" id="instr-17">-->
<!--                </span>-->
<!--                <hr data-text="Crossings">-->
<!--                <span class="instr" title="Cross to the right, above (pair with cross left)">-->
<!--                  <label for="instr-13">Right Above</label>-->
<!--                  <input type="radio" name="instr" id="instr-13">-->
<!--                </span>-->
<!--                <span class="instr" title="Cross to the right, below (pair with cross left)">-->
<!--                  <label for="instr-14">Right Below</label>-->
<!--                  <input type="radio" name="instr" id="instr-14">-->
<!--                </span>-->
<!--                <span class="instr" title="Cross to the left, above (pair with cross right)">-->
<!--                  <label for="instr-15">Left Above</label>-->
<!--                  <input type="radio" name="instr" id="instr-15">-->
<!--                </span>-->
<!--                <span class="instr" title="Cross to the left, below (pair with cross right)">-->
<!--                  <label for="instr-16">Left Below</label>-->
<!--                  <input type="radio" name="instr" id="instr-16">-->
<!--                </span>-->
              </div> <!-- end.bottom -->
            </span> <!-- end #pattern-instr -->
            <span class="group" data-legend="Layers" id="layer-group">
              <span id="active-layer">Select node</span>
              <select id="layer-type" disabled>
                <option value="-1">Program</option>
                <option value="0">Drawing</option>
                <option value="1">Scaling</option>
                <option value="2">Tiling</option>
              </select>
              <div class="bottom">
                <ul id="pattern-layers">
                </ul>
                <div class="right">
                  <a class="button" id="layer-add" title="Add new layer">+</a>
                  <a class="button" id="layer-remove" title="Delete layer">-</a>
                  <a class="button" id="layer-up" title="Move layer earlier">^</a>
                  <a class="button" id="layer-down" title="Move layer later">v</a>
                  <a class="button" id="layer-save" title="Load layer pattern">Save</a>

                  <div class="button load-action" id="load_layer">
                    Load
                    <div class="load-menu">
                      <a class="file button" id="layer-load" title="Load pattern as new layer">from file</a>
                      <select class="button" id="layer-use"><option value="">from server</option></select>
                    </div>
                  </div>
                  <!-- <a class="button" id="layer-load" title="Load pattern as new layer">Load</a> -->
                  <a class="button" id="layer-copy" title="Duplicate layer">Copy</a>
                  <a class="button" id="layer-side" title="Switch sides">Fr/Bk</a>
                  <input type="file" id="layer-file" accept=".pat, .png, .jpg">
                </div>
              </div>
            </span> <!-- end #layer-group -->
          </span> <!-- end .for-pattern -->
        </span> <!-- end .for-layout -->
    <span class="for-dat">
          <select id="cast_on_type" title="Cast On Method">
            <option value="interlock">Interlock (faster)</option>
            <!-- <option value="kickback">Kickback (better)</option> -->
            <option value="tuck">Tuck (unravels)</option>
            <option value="none">None (unravels)</option>
          </select>
          <select id="cast_off_type" title="Cast Off Method">
            <option value="direct">Direct (simpler)</option>
            <option value="reverse">Reverse (better)</option>
            <option value="pickup">Pickup (looser)</option>
            <option value="none">None (unravels)</option>
          </select>
          <input id="waste_fabric" type="checkbox" data-text="Waste Fabric" style="display: none;" />
          <input id="use_dscs" type="checkbox" data-text="Use DSCS" title="Digital Stitch Control System">
          <input id="dat_margin" type="checkbox" data-text="DAT Margin" checked>
        </span>
    <div id="settings">
      <i class="icon"></i>
      <ul>
        <li>
          <label for="opt_level">Opt. level</label>
          <select id="opt_level">
            <option value="group">Group</option>
            <option value="bed">Bed</option>
            <option value="none">None</option>
            <option value="debug">Debug</option>
          </select>
        </li>
        <li>
          <label for="verbose">Verbose</label>
          <input type="checkbox" id="verbose"></input>
        </li>
        <li>
          <label for="keepDuplicates">Duplicates</label>
          <input type="checkbox" id="keepDuplicates"></input>
        </li>
        <li>
          <label for="showBG">Background</label>
          <input type="checkbox" id="showBG" checked></input>
        </li>
        <li>
          <label for="showBeds">Show beds</label>
          <input type="checkbox" id="showBeds" checked></input>
        </li>
        <li>
          <label for="showFlow">Show flow</label>
          <input type="checkbox" id="showFlow" checked></input>
        </li>
        <li>
          <label for="showLabels">Show labels</label>
          <input type="checkbox" id="showLabels" checked></input>
        </li>
        <li>
          <label for="showNodes">Show nodes</label>
          <input type="checkbox" id="showNodes" checked></input>
        </li>
      </ul>
    </div>
  </div>
  <!-- Output layers -->
  <div id="output-layout"></div>
  <div id="output-dat"></div>
  <div id="output-mesh"></div>
</div>

<!-- Skeleton panel -->
<div id="skeleton-editor" class="panel closed">
  <h2>Skeleton Editor</h2>
  <div class="legend">
    <span class="sheet">Sheet</span>
    <span class="tube">Tube</span>
    <span class="joint">Joint</span>
    <!-- <span class="anchor">Anchor</span> -->
    <span class="split">Split</span>
    <span class="param">Param</span>
    <span class="interface">Interface</span>
  </div>
  <div id="skeleton-graph"></div>
  <div class="options">
    <label for="output_start">Root</label>
    <select id="output_start"></select>
    <hr />
    <label for="create_category">Node</label>
    <select id="create_category">
      <option>Sheet</option>
      <option>Joint</option>
      <option>Split</option>
    </select>
    <a class="button" id="create">Create</a>
    <hr />
    <label for="filter">Filter</label>
    <input type="text" placeholder="Filter query" id="filter" value="" />
  </div>
  <ul id="skeleton">
    <li class="node"><span class="name">root</span> <span class="create">+</span> <span class="delete">-</span></li>
    <li class="edge">branch</li>
    <li class="node">end</li>
  </ul>
</div>

<!-- Parameter panel -->
<div id="params-editor" class="panel closed">
  <h2 class="selection">Parameters of <span id="sname">?</span></h2>
  <form id="params"></form>
</div>

<!-- Layout(param) panel -->
<div id="layout-editor" class="panel closed">
  <h2>Layout Editor</h2>
  <div class="options">
    <label for="layout-auto">Automatic</label>
    <input  id="layout-auto" checked type="checkbox">
  </div>
  <ul id="layout_list" class="auto">
    <li>
      <input type="number" min="0" max="1" step="0.01" value="0">
    </li>
  </ul>
  <canvas></canvas>
</div>

<!-- History panel -->
<div id="history-editor" class="panel closed">
  <h2>History</h2>
  <div class="options">
    <label for="history-type">Type</label>
    <select id="history-type">
      <option value="none">No history</option>
      <option value="by-action">Every action</option>
      <option value="by-time">Every 5s</option>
    </select>
  </div>
  <ul id="history">
    <li>
      <span class="time">Right now</span>
      <span class="summary">Initial</span>
    </li>
  </ul>
  <a class="button" id="save_history">Export history</a>
  <a class="button" id="load_history">Load history</a>
  <input type="file" id="file_history" accept=".json">
</div>

<!-- Function(param) panel -->
<div id="function-editor" class="panel closed">
  <h2>Function editor for <span id="fname">?</span></h2>
  <div class="options">

    <label for="function-index">Index</label>
    <select id="function-index" value="0">
      <option value="0">0</option>
      <option value="1">1</option>
    </select>

    <label for="function-value">Value</label>
    <input id="function-value" type="number" min="0" step="0.01" value="5">

    <label for="function-index-change" class="change">Move Index</label>
    <input id="function-index-change"  class="change" type="number" min="0" step="0.01" max="1" value="0.5" />

    <a id="function-create" class="create">+</a>
    <a id="function-delete" class="delete">-</a>
  </div>
  <div id="function"></div>
</div>

<!-- Shaper(param) panel -->
<div id="shaper-editor" class="panel closed">
  <h2>Shaper Editor</h2>
  <div class="options">
    <select id="shaper_name">
      <option value="left">Left</option>
      <option value="right">Right</option>
    </select>
    <label for="shaper_manual">Manual</label>
    <input id="shaper_manual" type="checkbox">
    <label for="M">M</label>
    <input id="M" type="number" min="1"  max="10"  value="10" step="1">
    <label for="N">N</label>
    <input id="N" type="number" min="10" max="100" value="15" step="1">
  </div>
  <br />
  <textarea id="user_shaper" class="texteditor" placeholder="Write your shaper code here"
            rows="10">
// no-shaper:
i -&gt; i</textarea>
  <div class="info" id="shaper_info"></div>
  <canvas id="shaper_output"></canvas>
</div>

<!-- Pattern(param) panel -->
<div id="pattern-editor" class="panel closed">
  <h2>Pattern Editor</h2>
  <div class="options">
    <label for="pattern_target">Target</label>
    <select id="pattern_target">
      <option value="-1">Initial Pattern</option>
      <option value="0">Sheet # 1</option>
      <option value="-2">Final Pattern</option>
    </select>
    <label for="pattern_list">Example</label>
    <select id="pattern_list">
      <option>Empty</option>
      <option>Rib 1x1</option>
      <option>Rib 2x2</option>
      <option>Mesh 1x1</option>
      <option>
    </select>
    <a class="button" id="load_pattern">Load</a>
    <a class="button" id="save_pattern">Save</a>
    <input type="file" id="file_pattern" accept=".pat">
  </div>
  <textarea id="pattern" class="texteditor" placeholder="Write your patterning code here"
            rows="20">// knitting code</textarea>
  <div class="info" id="pattern_info"></div>

  <h2>Documentation</h2>
  <p>
    You can use the following methods:
  </p>
  <ul id="pattern_docu">

  </ul>
</div>

<!-- Custom(code) panel -->
<div id="custom-editor" class="panel closed">
  <h2>Custom Node Editor</h2>
  <div class="options">
    <label for="custom_target">Target</label>
    <select id="custom_target">
    </select>
    <a class="button" id="load_custom">Load</a>
    <a class="button" id="save_custom">Save</a>
    <input type="file" id="file_custom" accept=".kcrs">
  </div>
  <textarea id="custom" class="texteditor" placeholder="Write your custom code here"
            rows="20">// knitting code</textarea>
  <div class="info" id="custom_info"></div>

  <h2>Documentation</h2>
  <p>
    You can use the following methods:
  </p>
  <ul id="custom_docu">
  </ul>
</div>
</div>
</body>
</html>


